# H5 ä¸å°ç¨‹åºåˆ†äº«åŠŸèƒ½ - å¿«é€Ÿå‚è€ƒ

## ğŸš€ æ ¸å¿ƒä»£ç 

### H5 é¡µé¢å‘é€æ¶ˆæ¯

**ä½ç½®**: `frontend/public/miniprogram/video-interview-host.html` - `showInviteModal()` å‡½æ•°

```javascript
// ç”Ÿæˆé‚€è¯·é“¾æ¥
const inviteLink = `${baseUrl}video-interview-guest.html?roomId=${roomId}`;

// é€šçŸ¥å°ç¨‹åº
if (typeof wx !== 'undefined' && wx.miniProgram) {
  wx.miniProgram.postMessage({
    data: {
      type: 'triggerShare',
      roomId: roomId,
      inviteLink: inviteLink,
      shareTitle: 'é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•',
      shareDesc: `é¢è¯•é—´å·ï¼š${roomId}`
    }
  });
}
```

---

### å°ç¨‹åºæ¥æ”¶æ¶ˆæ¯

**ä½ç½®**: `miniprogram-pages/interview/interview.js` - `handleMessage()` å‡½æ•°

```javascript
case 'triggerShare':
  // è§¦å‘åˆ†äº«
  this.setData({
    roomId: lastMessage.roomId,
    shareData: {
      inviteLink: lastMessage.inviteLink,
      shareTitle: lastMessage.shareTitle || 'é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•',
      shareDesc: lastMessage.shareDesc || `é¢è¯•é—´å·ï¼š${lastMessage.roomId}`
    }
  });
  
  // æç¤ºç”¨æˆ·ä½¿ç”¨å³ä¸Šè§’åˆ†äº«
  wx.showModal({
    title: 'åˆ†äº«é‚€è¯·',
    content: 'è¯·ç‚¹å‡»å³ä¸Šè§’"..."æŒ‰é’®ï¼Œé€‰æ‹©"è½¬å‘"åˆ†äº«ç»™å€™é€‰äºº',
    showCancel: false,
    confirmText: 'çŸ¥é“äº†'
  });
  break;
```

---

### å°ç¨‹åºç”Ÿæˆåˆ†äº«å¡ç‰‡

**ä½ç½®**: `miniprogram-pages/interview/interview.js` - `onShareAppMessage()` å‡½æ•°

```javascript
onShareAppMessage() {
  const { roomId, shareData } = this.data;
  
  if (!roomId) {
    return {
      title: 'å®‰å¾—å®¶æ”¿ - è§†é¢‘é¢è¯•',
      path: '/pages/index/index'
    };
  }
  
  const shareTitle = shareData?.shareTitle || 'é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•';
  
  return {
    title: shareTitle,
    path: `/pages/interview/interview?roomId=${roomId}`,
    imageUrl: '/images/share-interview.png'
  };
}
```

---

## ğŸ“Š æ¶ˆæ¯æ ¼å¼

### H5 â†’ å°ç¨‹åº

```json
{
  "type": "triggerShare",
  "roomId": "room_1234567890_abc123",
  "inviteLink": "https://crm.andejiazheng.com/miniprogram/video-interview-guest.html?roomId=room_1234567890_abc123",
  "shareTitle": "é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•",
  "shareDesc": "é¢è¯•é—´å·ï¼šroom_1234567890_abc123"
}
```

### å°ç¨‹åºåˆ†äº«é…ç½®

```json
{
  "title": "é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•",
  "path": "/pages/interview/interview?roomId=room_1234567890_abc123",
  "imageUrl": "/images/share-interview.png"
}
```

---

## ğŸ” è°ƒè¯•æ—¥å¿—

### H5 é¡µé¢æ—¥å¿—
```
ğŸ“¨ æ˜¾ç¤ºé‚€è¯·å¼¹çª—
ğŸ  å½“å‰roomId: room_1234567890_abc123
ğŸ”— ç”Ÿæˆçš„é‚€è¯·é“¾æ¥: https://crm.andejiazheng.com/miniprogram/video-interview-guest.html?roomId=room_1234567890_abc123
âœ… å·²é€šçŸ¥å°ç¨‹åºï¼šè§¦å‘åˆ†äº«
ğŸ“¤ åˆ†äº«æ•°æ®: { type: 'triggerShare', roomId: 'room_1234567890_abc123', inviteLink: '...' }
```

### å°ç¨‹åºæ—¥å¿—
```
ğŸ“¥ æ”¶åˆ°H5æ¶ˆæ¯: [...]
ğŸ“¤ è§¦å‘åˆ†äº«: { type: 'triggerShare', roomId: 'room_1234567890_abc123', ... }
ğŸ’¾ å·²ä¿å­˜åˆ†äº«æ•°æ®: { inviteLink: '...', shareTitle: '...', shareDesc: '...' }
ğŸ“¤ ç”¨æˆ·ç‚¹å‡»åˆ†äº«æŒ‰é’®
ğŸ“¤ å½“å‰ roomId: room_1234567890_abc123
ğŸ“¤ å½“å‰ shareData: { inviteLink: '...', shareTitle: '...', shareDesc: '...' }
âœ… ç”Ÿæˆåˆ†äº«é…ç½®: { title: 'é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•', path: '/pages/interview/interview?roomId=room_1234567890_abc123' }
```

---

## âš¡ å¿«é€Ÿæµ‹è¯•

### 1. æµ‹è¯• H5 å‘é€æ¶ˆæ¯
åœ¨ H5 é¡µé¢ Console ä¸­æ‰§è¡Œï¼š
```javascript
console.log('å½“å‰ roomId:', roomId);
console.log('wx å¯¹è±¡:', typeof wx !== 'undefined' ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
console.log('wx.miniProgram:', typeof wx !== 'undefined' && wx.miniProgram ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
```

### 2. æµ‹è¯•å°ç¨‹åºæ¥æ”¶æ¶ˆæ¯
åœ¨å°ç¨‹åº Console ä¸­æŸ¥çœ‹ï¼š
```javascript
console.log('å½“å‰ roomId:', this.data.roomId);
console.log('å½“å‰ shareData:', this.data.shareData);
```

### 3. æµ‹è¯•åˆ†äº«åŠŸèƒ½
1. ç‚¹å‡»å³ä¸Šè§’"..."
2. é€‰æ‹©"è½¬å‘"
3. æŸ¥çœ‹ Console è¾“å‡ºçš„åˆ†äº«é…ç½®

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. âœ… `frontend/public/miniprogram/video-interview-host.html`
   - ä¿®æ”¹äº† `showInviteModal()` å‡½æ•°
   - æ·»åŠ äº†å‘å°ç¨‹åºå‘é€ `triggerShare` æ¶ˆæ¯çš„ä»£ç 

2. âœ… `miniprogram-pages/interview/interview.js`
   - æ·»åŠ äº† `shareData` æ•°æ®å­—æ®µ
   - æ·»åŠ äº† `roomCreated` å’Œ `triggerShare` æ¶ˆæ¯å¤„ç†
   - æ›´æ–°äº† `onShareAppMessage()` å’Œ `onShareTimeline()` å‡½æ•°

---

## ğŸ¯ å…³é”®ç‚¹

1. **æ¶ˆæ¯ç±»å‹**: å¿…é¡»æ˜¯ `'triggerShare'`
2. **å¿…éœ€å­—æ®µ**: `roomId`ã€`inviteLink`
3. **å¯é€‰å­—æ®µ**: `shareTitle`ã€`shareDesc`
4. **ç¯å¢ƒæ£€æµ‹**: ä½¿ç”¨ `typeof wx !== 'undefined' && wx.miniProgram`
5. **æ¶ˆæ¯æ—¶æœº**: `postMessage` åœ¨åˆ†äº«æ—¶æ‰ä¼šè¢«å°ç¨‹åºæ¥æ”¶

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- ğŸ“„ [H5ä¸å°ç¨‹åºåˆ†äº«åŠŸèƒ½å¯¹æ¥æ–‡æ¡£](./H5ä¸å°ç¨‹åºåˆ†äº«åŠŸèƒ½å¯¹æ¥æ–‡æ¡£.md) - åŸå§‹éœ€æ±‚æ–‡æ¡£
- ğŸ“„ [H5ä¸å°ç¨‹åºåˆ†äº«åŠŸèƒ½å®ç°æ€»ç»“](./H5ä¸å°ç¨‹åºåˆ†äº«åŠŸèƒ½å®ç°æ€»ç»“.md) - è¯¦ç»†å®ç°è¯´æ˜
- ğŸ“„ [H5ä¸å°ç¨‹åºåˆ†äº«åŠŸèƒ½æµ‹è¯•æŒ‡å—](./H5ä¸å°ç¨‹åºåˆ†äº«åŠŸèƒ½æµ‹è¯•æŒ‡å—.md) - å®Œæ•´æµ‹è¯•æ­¥éª¤

