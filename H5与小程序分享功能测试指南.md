# H5 ä¸å°ç¨‹åºåˆ†äº«åŠŸèƒ½æµ‹è¯•æŒ‡å—

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. H5 é¡µé¢ä¿®æ”¹
**æ–‡ä»¶**: `frontend/public/miniprogram/video-interview-host.html`

åœ¨ `showInviteModal()` å‡½æ•°ä¸­æ·»åŠ äº†å‘å°ç¨‹åºå‘é€æ¶ˆæ¯çš„åŠŸèƒ½ï¼š

```javascript
// ğŸ”¥ é€šçŸ¥å°ç¨‹åºï¼ˆç”¨äºåˆ†äº«åŠŸèƒ½ï¼‰
if (typeof wx !== 'undefined' && wx.miniProgram) {
  wx.miniProgram.postMessage({
    data: {
      type: 'triggerShare',
      roomId: roomId,
      inviteLink: inviteLink,
      shareTitle: 'é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•',
      shareDesc: `é¢è¯•é—´å·ï¼š${roomId}`
    }
  });
  console.log('âœ… å·²é€šçŸ¥å°ç¨‹åºï¼šè§¦å‘åˆ†äº«');
}
```

### 2. å°ç¨‹åºé¡µé¢ä¿®æ”¹
**æ–‡ä»¶**: `miniprogram-pages/interview/interview.js`

#### 2.1 æ·»åŠ æ•°æ®å­—æ®µ
```javascript
data: {
  webviewUrl: '',
  roomId: '',
  shareData: null // å­˜å‚¨åˆ†äº«æ•°æ®
}
```

#### 2.2 å¤„ç† H5 æ¶ˆæ¯
æ·»åŠ äº†ä¸¤ç§æ–°æ¶ˆæ¯ç±»å‹çš„å¤„ç†ï¼š

- **`roomCreated`**: é¢è¯•é—´åˆ›å»ºæˆåŠŸæ—¶ä¿å­˜ roomId
- **`triggerShare`**: è§¦å‘åˆ†äº«æ—¶ä¿å­˜åˆ†äº«æ•°æ®å¹¶æç¤ºç”¨æˆ·

#### 2.3 æ›´æ–°åˆ†äº«åŠŸèƒ½
`onShareAppMessage()` å’Œ `onShareTimeline()` ç°åœ¨ä¼šä½¿ç”¨ä» H5 æ¥æ”¶åˆ°çš„åˆ†äº«æ•°æ®ã€‚

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æµ‹è¯•ç¯å¢ƒ
- å¾®ä¿¡å¼€å‘è€…å·¥å…·
- å°ç¨‹åºé¡¹ç›®

### æ­¥éª¤ 1: å‡†å¤‡æµ‹è¯•ç¯å¢ƒ

1. æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·
2. åŠ è½½å°ç¨‹åºé¡¹ç›®
3. ç¡®ä¿å·²å°†ä¿®æ”¹åçš„æ–‡ä»¶å¤åˆ¶åˆ°å°ç¨‹åºé¡¹ç›®ä¸­ï¼š
   - `miniprogram-pages/interview/interview.js`
   - `miniprogram-pages/interview/interview.wxml`
   - `miniprogram-pages/interview/interview.json`

### æ­¥éª¤ 2: æµ‹è¯•é¢è¯•é—´åˆ›å»º

1. åœ¨å°ç¨‹åºä¸­è¿›å…¥è§†é¢‘é¢è¯•é¡µé¢
2. æ‰“å¼€å¼€å‘è€…å·¥å…·çš„ Console æ§åˆ¶å°
3. åˆ›å»ºé¢è¯•é—´
4. **é¢„æœŸç»“æœ**ï¼š
   ```
   âœ… é¢è¯•é—´åˆ›å»ºæˆåŠŸ: room_xxx
   ğŸ’¾ å·²ä¿å­˜ roomId åˆ°å°ç¨‹åºæ•°æ®: room_xxx
   ```

### æ­¥éª¤ 3: æµ‹è¯•é‚€è¯·åŠŸèƒ½

1. åœ¨è§†é¢‘é¢è¯•ç•Œé¢ç‚¹å‡»"é‚€è¯·"æŒ‰é’®ï¼ˆæˆ–"+"æŒ‰é’®ï¼‰
2. **é¢„æœŸç»“æœ**ï¼š
   - H5 é¡µé¢ Console è¾“å‡ºï¼š
     ```
     ğŸ“¨ æ˜¾ç¤ºé‚€è¯·å¼¹çª—
     ğŸ”— ç”Ÿæˆçš„é‚€è¯·é“¾æ¥: https://crm.andejiazheng.com/miniprogram/video-interview-guest.html?roomId=room_xxx
     âœ… å·²é€šçŸ¥å°ç¨‹åºï¼šè§¦å‘åˆ†äº«
     ğŸ“¤ åˆ†äº«æ•°æ®: { type: 'triggerShare', roomId: 'room_xxx', inviteLink: '...' }
     ```
   - å°ç¨‹åº Console è¾“å‡ºï¼š
     ```
     ğŸ“¥ æ”¶åˆ°H5æ¶ˆæ¯: [...]
     ğŸ“¤ è§¦å‘åˆ†äº«: { type: 'triggerShare', roomId: 'room_xxx', ... }
     ğŸ’¾ å·²ä¿å­˜åˆ†äº«æ•°æ®: { inviteLink: '...', shareTitle: '...', shareDesc: '...' }
     ```
   - å¼¹å‡ºæç¤ºæ¡†ï¼š
     ```
     æ ‡é¢˜: åˆ†äº«é‚€è¯·
     å†…å®¹: è¯·ç‚¹å‡»å³ä¸Šè§’"..."æŒ‰é’®ï¼Œé€‰æ‹©"è½¬å‘"åˆ†äº«ç»™å€™é€‰äºº
     ```

### æ­¥éª¤ 4: æµ‹è¯•åˆ†äº«åŠŸèƒ½

1. ç‚¹å‡»å°ç¨‹åºå³ä¸Šè§’"..."æŒ‰é’®
2. é€‰æ‹©"è½¬å‘"
3. **é¢„æœŸç»“æœ**ï¼š
   - å°ç¨‹åº Console è¾“å‡ºï¼š
     ```
     ğŸ“¤ ç”¨æˆ·ç‚¹å‡»åˆ†äº«æŒ‰é’®
     ğŸ“¤ å½“å‰ roomId: room_xxx
     ğŸ“¤ å½“å‰ shareData: { inviteLink: '...', shareTitle: '...', shareDesc: '...' }
     âœ… ç”Ÿæˆåˆ†äº«é…ç½®: { title: 'é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•', path: '/pages/interview/interview?roomId=room_xxx' }
     ```
   - åˆ†äº«å¡ç‰‡æ˜¾ç¤ºï¼š
     - æ ‡é¢˜: "é‚€è¯·ä½ å‚åŠ è§†é¢‘é¢è¯•"
     - è·¯å¾„: `/pages/interview/interview?roomId=room_xxx`

### æ­¥éª¤ 5: æµ‹è¯•è®¿å®¢æ¥æ”¶åˆ†äº«

1. å°†åˆ†äº«å¡ç‰‡å‘é€ç»™æµ‹è¯•è´¦å·ï¼ˆæˆ–è‡ªå·±ï¼‰
2. ç‚¹å‡»åˆ†äº«å¡ç‰‡
3. **é¢„æœŸç»“æœ**ï¼š
   - å°ç¨‹åºæ‰“å¼€è§†é¢‘é¢è¯•é¡µé¢
   - URL å‚æ•°åŒ…å«æ­£ç¡®çš„ roomId
   - è®¿å®¢å¯ä»¥åŠ å…¥é¢è¯•é—´

---

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹ H5 å‘é€çš„æ¶ˆæ¯
åœ¨ H5 é¡µé¢çš„ Console ä¸­æŸ¥çœ‹ï¼š
```javascript
console.log('ğŸ“¤ å‘é€æ¶ˆæ¯ç»™å°ç¨‹åº:', { type: 'triggerShare', roomId: roomId, inviteLink: inviteLink });
```

### æŸ¥çœ‹å°ç¨‹åºæ¥æ”¶çš„æ¶ˆæ¯
åœ¨å°ç¨‹åºçš„ Console ä¸­æŸ¥çœ‹ï¼š
```javascript
console.log('ğŸ“¥ æ”¶åˆ°H5æ¶ˆæ¯:', e.detail.data);
console.log('ğŸ“¥ å¤„ç†æ¶ˆæ¯:', lastMessage);
```

### æŸ¥çœ‹åˆ†äº«æ•°æ®
åœ¨å°ç¨‹åºçš„ Console ä¸­æŸ¥çœ‹ï¼š
```javascript
console.log('ğŸ“¤ å½“å‰ shareData:', this.data.shareData);
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **postMessage æ—¶æœº**: `wx.miniProgram.postMessage()` çš„æ¶ˆæ¯ä¸æ˜¯å®æ—¶æ¥æ”¶çš„ï¼Œè€Œæ˜¯åœ¨ä»¥ä¸‹æ—¶æœºè§¦å‘ï¼š
   - å°ç¨‹åºåé€€
   - ç»„ä»¶é”€æ¯
   - **åˆ†äº«æ—¶** âœ…

2. **ç¯å¢ƒæ£€æµ‹**: H5 é¡µé¢ä¼šæ£€æµ‹æ˜¯å¦åœ¨å°ç¨‹åºç¯å¢ƒä¸­ï¼š
   ```javascript
   if (typeof wx !== 'undefined' && wx.miniProgram) {
     // åœ¨å°ç¨‹åºä¸­
   }
   ```

3. **åˆ†äº«å›¾ç‰‡**: éœ€è¦å‡†å¤‡åˆ†äº«å›¾ç‰‡ `/images/share-interview.png`

---

## ğŸ“ å®Œæ•´æµç¨‹å›¾

```
HR åˆ›å»ºé¢è¯•é—´
    â†“
H5 å‘é€ roomCreated æ¶ˆæ¯
    â†“
å°ç¨‹åºä¿å­˜ roomId
    â†“
HR ç‚¹å‡»"é‚€è¯·"æŒ‰é’®
    â†“
H5 ç”Ÿæˆ inviteLink
    â†“
H5 å‘é€ triggerShare æ¶ˆæ¯
    â†“
å°ç¨‹åºä¿å­˜ shareData
    â†“
å°ç¨‹åºæç¤ºç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«
    â†“
ç”¨æˆ·ç‚¹å‡»"è½¬å‘"
    â†“
å°ç¨‹åºç”Ÿæˆåˆ†äº«å¡ç‰‡ï¼ˆä½¿ç”¨ shareDataï¼‰
    â†“
è®¿å®¢æ”¶åˆ°åˆ†äº«å¡ç‰‡
    â†“
è®¿å®¢ç‚¹å‡»å¡ç‰‡
    â†“
è®¿å®¢åŠ å…¥é¢è¯•é—´
```

---

## ğŸ‰ æµ‹è¯•é€šè¿‡æ ‡å‡†

- âœ… H5 é¡µé¢èƒ½æ­£ç¡®ç”Ÿæˆ inviteLink
- âœ… H5 é¡µé¢èƒ½å‘å°ç¨‹åºå‘é€ triggerShare æ¶ˆæ¯
- âœ… å°ç¨‹åºèƒ½æ¥æ”¶å¹¶ä¿å­˜ shareData
- âœ… å°ç¨‹åºåˆ†äº«æ—¶ä½¿ç”¨æ­£ç¡®çš„ roomId å’Œ shareData
- âœ… è®¿å®¢èƒ½é€šè¿‡åˆ†äº«å¡ç‰‡åŠ å…¥é¢è¯•é—´

