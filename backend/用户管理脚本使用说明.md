# ç”¨æˆ·ç®¡ç†è„šæœ¬ä½¿ç”¨è¯´æ˜

## æ¦‚è¿°

æœ¬ç›®å½•åŒ…å«äº†ä¸€ç³»åˆ—ç”¨äºç®¡ç†ç³»ç»Ÿç”¨æˆ·çš„ Node.js è„šæœ¬ï¼Œå¯ä»¥ç›´æ¥æ“ä½œ MongoDB æ•°æ®åº“è¿›è¡Œç”¨æˆ·ç®¡ç†ã€‚

## å¯ç”¨è„šæœ¬

### 1. åˆ—å‡ºæ‰€æœ‰ç”¨æˆ· (list-all-users.js)

æŸ¥çœ‹æ•°æ®åº“ä¸­çš„æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ã€‚

**ä½¿ç”¨æ–¹æ³•:**
```bash
cd backend
node list-all-users.js
```

**è¾“å‡ºå†…å®¹:**
- ç”¨æˆ·æ€»æ•°
- æ¯ä¸ªç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼ˆç”¨æˆ·åã€å§“åã€è§’è‰²ã€çŠ¶æ€ç­‰ï¼‰
- æœç´¢åŒ…å«ç‰¹å®šå…³é”®è¯çš„ç”¨æˆ·

---

### 2. æ£€æŸ¥ç‰¹å®šç”¨æˆ· (check-user-zhaoyaoru.js)

æ£€æŸ¥ `zhaoyaoru` ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç™»å½•æ—¥å¿—å’Œå¯†ç æµ‹è¯•ã€‚

**ä½¿ç”¨æ–¹æ³•:**
```bash
cd backend
node check-user-zhaoyaoru.js
```

**è¾“å‡ºå†…å®¹:**
- ç”¨æˆ·å®Œæ•´ä¿¡æ¯
- å¯†ç æµ‹è¯•ç»“æœ
- æœ€è¿‘çš„ç™»å½•æ—¥å¿—
- é—®é¢˜è¯Šæ–­å’Œä¿®å¤å»ºè®®

---

### 3. åˆ›å»ºç”¨æˆ· (create-user-zhaoyaoru.js)

åˆ›å»º `zhaoyaoru` ç”¨æˆ·ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ã€‚

**ä½¿ç”¨æ–¹æ³•:**
```bash
cd backend
node create-user-zhaoyaoru.js
```

**é»˜è®¤é…ç½®:**
- ç”¨æˆ·å: `zhaoyaoru`
- å§“å: `èµµè€€å¦‚`
- é»˜è®¤å¯†ç : `123456`
- è§’è‰²: `user`
- çŠ¶æ€: å·²æ¿€æ´»

âš ï¸ **æ³¨æ„:** åˆ›å»ºåè¯·æé†’ç”¨æˆ·ç«‹å³ä¿®æ”¹å¯†ç ï¼

---

### 4. é‡ç½®ç”¨æˆ·å¯†ç  (reset-user-password.js)

é‡ç½®ä»»æ„ç”¨æˆ·çš„å¯†ç ã€‚

**ä½¿ç”¨æ–¹æ³•:**
```bash
cd backend
node reset-user-password.js <ç”¨æˆ·å> <æ–°å¯†ç >
```

**ç¤ºä¾‹:**
```bash
# é‡ç½® zhaoyaoru çš„å¯†ç ä¸º 123456
node reset-user-password.js zhaoyaoru 123456

# é‡ç½® admin çš„å¯†ç ä¸º admin123
node reset-user-password.js admin admin123
```

---

### 5. æµ‹è¯•ç™»å½• (test-login.js)

æµ‹è¯•ç”¨æˆ·ç™»å½•å‡­æ®æ˜¯å¦æ­£ç¡®ã€‚

**ä½¿ç”¨æ–¹æ³•:**
```bash
cd backend
node test-login.js <ç”¨æˆ·å> <å¯†ç >
```

**ç¤ºä¾‹:**
```bash
# æµ‹è¯• zhaoyaoru ç”¨æˆ·ç™»å½•
node test-login.js zhaoyaoru 123456
```

**è¾“å‡ºå†…å®¹:**
- ç”¨æˆ·ä¿¡æ¯
- è´¦å·çŠ¶æ€æ£€æŸ¥
- å¯†ç éªŒè¯ç»“æœ
- ç™»å½•æˆåŠŸ/å¤±è´¥æç¤º

---

## å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜ 1: ç”¨æˆ·ç™»å½•ä¸äº†

**è¯Šæ–­æ­¥éª¤:**

1. **æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨**
   ```bash
   node list-all-users.js
   ```

2. **å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œåˆ›å»ºç”¨æˆ·**
   ```bash
   node create-user-zhaoyaoru.js
   ```

3. **å¦‚æœç”¨æˆ·å­˜åœ¨ä½†å¯†ç é”™è¯¯ï¼Œé‡ç½®å¯†ç **
   ```bash
   node reset-user-password.js zhaoyaoru 123456
   ```

4. **æµ‹è¯•ç™»å½•**
   ```bash
   node test-login.js zhaoyaoru 123456
   ```

### é—®é¢˜ 2: è´¦å·è¢«ç¦ç”¨

å¦‚æœç”¨æˆ·çš„ `active` å­—æ®µä¸º `false`ï¼Œéœ€è¦åœ¨æ•°æ®åº“ä¸­æ‰‹åŠ¨å¯ç”¨ï¼š

```javascript
// ä½¿ç”¨ MongoDB shell æˆ–åˆ›å»ºè„šæœ¬
db.users.updateOne(
  { username: "zhaoyaoru" },
  { $set: { active: true } }
)
```

### é—®é¢˜ 3: å¯†ç å“ˆå¸Œå¼‚å¸¸

å¦‚æœå¯†ç å“ˆå¸Œé•¿åº¦å¼‚å¸¸æˆ–æ ¼å¼ä¸æ­£ç¡®ï¼Œä½¿ç”¨é‡ç½®å¯†ç è„šæœ¬é‡æ–°ç”Ÿæˆï¼š

```bash
node reset-user-password.js zhaoyaoru 123456
```

---

## å®‰å…¨å»ºè®®

1. âš ï¸ **ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å¼±å¯†ç **ï¼ˆå¦‚ `123456`ï¼‰
2. ğŸ”’ **åˆ›å»ºç”¨æˆ·åç«‹å³è¦æ±‚ç”¨æˆ·ä¿®æ”¹å¯†ç **
3. ğŸ“ **å®šæœŸæ£€æŸ¥ç™»å½•æ—¥å¿—ï¼Œå‘ç°å¼‚å¸¸ç™»å½•è¡Œä¸º**
4. ğŸ” **ä¸ºç®¡ç†å‘˜è´¦å·è®¾ç½®å¼ºå¯†ç **
5. ğŸš« **ä¸è¦å°†å¯†ç æ˜æ–‡è®°å½•åœ¨æ—¥å¿—æˆ–æ–‡æ¡£ä¸­**

---

## æŠ€æœ¯è¯´æ˜

- **å¯†ç åŠ å¯†**: ä½¿ç”¨ bcrypt ç®—æ³•ï¼Œå·¥ä½œå› å­ä¸º 10
- **æ•°æ®åº“**: MongoDB
- **è¿æ¥å­—ç¬¦ä¸²**: é»˜è®¤ä¸º `mongodb://localhost:27017/andejiazheng`
- **ç¯å¢ƒå˜é‡**: å¯é€šè¿‡ `MONGODB_URI` ç¯å¢ƒå˜é‡è‡ªå®šä¹‰æ•°æ®åº“è¿æ¥

---

## ç»´æŠ¤è®°å½•

- **2025-12-06**: åˆ›å»ºç”¨æˆ·ç®¡ç†è„šæœ¬å¥—ä»¶
- **2025-12-06**: æˆåŠŸåˆ›å»º `zhaoyaoru` ç”¨æˆ·ï¼Œé»˜è®¤å¯†ç  `123456`

