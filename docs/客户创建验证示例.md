# 客户创建验证示例

## 有效的客户数据示例

### 示例 1：只填写手机号
```json
{
  "name": "张三",
  "phone": "13812345678",
  "leadSource": "美团",
  "contractStatus": "匹配中",
  "leadLevel": "A类"
}
```
✅ **验证通过** - 有手机号，符合要求

---

### 示例 2：只填写微信号
```json
{
  "name": "李四",
  "wechatId": "wechat_lisi",
  "leadSource": "抖音",
  "contractStatus": "匹配中",
  "leadLevel": "B类"
}
```
✅ **验证通过** - 有微信号，符合要求

---

### 示例 3：同时填写手机号和微信号
```json
{
  "name": "王五",
  "phone": "13987654321",
  "wechatId": "wechat_wangwu",
  "leadSource": "小红书",
  "contractStatus": "已签约",
  "leadLevel": "A类",
  "salaryBudget": 8000,
  "serviceCategory": "月嫂"
}
```
✅ **验证通过** - 两者都有，符合要求

---

## 无效的客户数据示例

### 示例 4：两者都不填写
```json
{
  "name": "赵六",
  "leadSource": "转介绍",
  "contractStatus": "待定",
  "leadLevel": "C类"
}
```
❌ **验证失败** - 错误信息：`"请填写手机号或微信号"`

---

### 示例 5：手机号格式错误
```json
{
  "name": "孙七",
  "phone": "12345678",
  "leadSource": "快手",
  "contractStatus": "匹配中",
  "leadLevel": "B类"
}
```
❌ **验证失败** - 错误信息：`"请输入有效的中国手机号码"`

---

### 示例 6：只填写空字符串
```json
{
  "name": "周八",
  "phone": "   ",
  "wechatId": "",
  "leadSource": "其他",
  "contractStatus": "匹配中",
  "leadLevel": "D类"
}
```
❌ **验证失败** - 错误信息：`"请填写手机号或微信号"`
（空格会被trim处理，视为空值）

---

## 前端表单验证示例

### React/Ant Design 表单
```tsx
<Form.Item
  label="客户电话"
  name="phone"
  rules={[
    { pattern: /^1[3-9]\d{9}$/, message: '请输入有效的手机号码' },
    {
      validator: async (_, value) => {
        const wechatId = form.getFieldValue('wechatId');
        if (!value?.trim() && !wechatId?.trim()) {
          return Promise.reject('请填写手机号或微信号');
        }
        return Promise.resolve();
      }
    }
  ]}
>
  <Input placeholder="请输入客户电话" />
</Form.Item>

<Form.Item
  label="微信号"
  name="wechatId"
  rules={[
    {
      validator: async (_, value) => {
        const phone = form.getFieldValue('phone');
        if (!value?.trim() && !phone?.trim()) {
          return Promise.reject('请填写手机号或微信号');
        }
        return Promise.resolve();
      }
    }
  ]}
>
  <Input placeholder="请输入微信号" />
</Form.Item>
```

---

## API 错误响应示例

### 创建客户失败 - 缺少联系方式
```http
POST /api/customers
Content-Type: application/json

{
  "name": "测试客户",
  "leadSource": "美团",
  "contractStatus": "匹配中",
  "leadLevel": "A类"
}
```

**响应：**
```json
{
  "statusCode": 400,
  "message": "请填写手机号或微信号",
  "error": "Bad Request"
}
```

---

### 更新客户失败 - 清空所有联系方式
```http
PATCH /api/customers/123456
Content-Type: application/json

{
  "phone": "",
  "wechatId": ""
}
```

**响应：**
```json
{
  "statusCode": 400,
  "message": "请填写手机号或微信号",
  "error": "Bad Request"
}
```

