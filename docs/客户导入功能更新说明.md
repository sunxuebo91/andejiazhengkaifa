# 客户导入功能更新说明

## 📅 更新时间
2024-01-20

## 🎯 更新内容

### 1. 新增导入字段支持

在原有基础上，新增以下字段的导入支持：

#### 必填字段（保持不变）
- ✅ 姓名
- ✅ 电话
- ✅ 线索来源

#### 新增可选字段
- ✅ **身份证号** - 客户身份证号码
- ✅ **预产期** - 孕妇客户的预产期
- ✅ **年龄要求** - 对阿姨的年龄要求（如：35-45岁）
- ✅ **性别要求** - 对阿姨的性别要求（如：女、不限）
- ✅ **籍贯要求** - 对阿姨的籍贯要求（如：江浙沪、不限）
- ✅ **学历要求** - 对阿姨的学历要求（枚举值：无学历、小学、初中、中专、职高、高中、大专、本科、研究生及以上）
- ✅ **成交金额** - 客户成交金额（单位：元）

#### 优化的字段
- ✅ **线索等级** - 现在支持默认值 "O类"（如果不填写）
- ✅ **客户状态** - 现在支持默认值 "待定"（如果不填写）

### 2. 导入模板更新

#### 新模板字段顺序
```
姓名, 电话, 线索来源, 客户状态, 线索等级, 微信号, 身份证号,
需求品类, 薪资预算, 期望上户日期, 预产期, 家庭面积, 家庭人口,
休息制度, 地址, 年龄要求, 性别要求, 籍贯要求, 学历要求, 成交金额, 备注
```

#### 示例数据
```csv
张三,13800138000,美团,待定,O类,wx123,110101199001011234,月嫂,8000,2024-12-01,2024-11-15,120,3,单休,北京市朝阳区,35-45岁,不限,不限,初中及以上,15000,需要有经验
李四,13900139000,抖音,匹配中,A类,,,住家育儿嫂,9000,2024-12-15,,150,4,双休,上海市浦东新区,30-40岁,女,江浙沪,高中及以上,,要求普通话标准
```

### 3. 字段枚举值说明

#### 线索来源（必填）
美团、抖音、快手、小红书、转介绍、杭州同馨、握个手平台、线索购买、莲心、美家、天机鹿、孕妈联盟、高阁、星星、其他

#### 客户状态（默认：待定）
已签约、匹配中、流失客户、已退款、退款中、待定

#### 线索等级（默认：O类）
O类、A类、B类、C类、D类、流失

#### 需求品类
月嫂、住家育儿嫂、保洁、住家保姆、养宠、小时工、白班育儿、白班保姆、住家护老

#### 休息制度
单休、双休、无休、调休、待定

#### 学历要求
无学历、小学、初中、中专、职高、高中、大专、本科、研究生及以上

## 🔧 技术实现

### 后端修改
**文件**: `backend/src/modules/customers/customers.service.ts`

**修改内容**:
- 更新 `mapExcelRowToCustomerDto` 方法
- 新增字段映射：身份证号、预产期、年龄要求、性别要求、籍贯要求、学历要求、成交金额
- 添加线索等级默认值 "O类"

### 前端修改
**文件**: `frontend/src/pages/customers/CustomerList.tsx`

**修改内容**:
- 更新 `downloadExcelTemplate` 方法
- 新增模板字段和示例数据
- 优化导入说明文字，增加字段枚举值说明

## 📋 使用说明

### 1. 下载最新模板
在客户列表页面点击"批量导入" → "下载模板"，获取最新的导入模板

### 2. 填写数据
按照模板格式填写客户数据，注意：
- 必填字段不能为空
- 枚举字段必须使用指定的值
- 日期格式：YYYY-MM-DD（如：2024-12-01）
- 数字字段直接填写数字（如：8000）

### 3. 上传导入
将填写好的Excel文件拖拽到上传区域或点击上传

### 4. 查看结果
系统会显示导入成功和失败的数量，以及详细的错误信息

## ⚠️ 注意事项

1. **手机号唯一性**：手机号重复的客户将导入失败
2. **枚举值严格匹配**：线索来源、客户状态等枚举字段必须使用指定的值
3. **日期格式**：日期字段必须使用 YYYY-MM-DD 格式
4. **数字范围**：
   - 薪资预算：1000-50000 元
   - 家庭面积：10-1000 平方米
   - 家庭人口：1-20 人
   - 成交金额：0-10000000 元

## 🎉 更新效果

- ✅ 支持更完整的客户信息导入
- ✅ 减少手动录入工作量
- ✅ 提高数据录入效率
- ✅ 更好的数据完整性

## 🚀 部署状态

- ✅ 后端已构建并重启
- ✅ 前端已构建并重启
- ✅ 功能已上线可用

