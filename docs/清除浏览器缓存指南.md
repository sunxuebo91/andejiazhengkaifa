# 清除浏览器缓存指南

## 🔍 问题现象

线索归属人下拉列表中没有显示管理员用户，但后端已经正确返回了管理员数据。

## ✅ 验证结果

通过测试脚本验证，后端查询正确返回了 **13个用户**，包括：
- ✅ **7个管理员**：孙学博、孙学博、孙学鑫、朱小双、梁云东、程聪、闫凯欣
- ✅ **6个员工**：刘黎黎、孔丽新、宋静、师丽娜、测试员工、赵瑶如

## 🎯 问题原因

**浏览器缓存**导致前端仍在使用旧的API响应数据。

## 🔧 解决方案

### 方案一：强制刷新（推荐）⭐

最简单快速的方法：

#### Windows / Linux
- **Chrome / Edge**: 按 `Ctrl + Shift + R` 或 `Ctrl + F5`
- **Firefox**: 按 `Ctrl + Shift + R` 或 `Ctrl + F5`

#### macOS
- **Chrome / Edge**: 按 `Cmd + Shift + R`
- **Firefox**: 按 `Cmd + Shift + R`
- **Safari**: 按 `Cmd + Option + R`

### 方案二：清除浏览器缓存

#### Chrome / Edge

1. 打开浏览器
2. 按 `Ctrl + Shift + Delete`（Windows）或 `Cmd + Shift + Delete`（Mac）
3. 选择时间范围：**全部时间**
4. 勾选：
   - ✅ 浏览历史记录
   - ✅ Cookie 及其他网站数据
   - ✅ 缓存的图片和文件
5. 点击"清除数据"
6. 刷新页面

#### Firefox

1. 打开浏览器
2. 按 `Ctrl + Shift + Delete`（Windows）或 `Cmd + Shift + Delete`（Mac）
3. 选择时间范围：**全部**
4. 勾选：
   - ✅ 浏览和下载历史
   - ✅ Cookie
   - ✅ 缓存
5. 点击"立即清除"
6. 刷新页面

#### Safari

1. 打开 Safari
2. 点击菜单栏 "Safari" > "偏好设置"
3. 选择"隐私"标签
4. 点击"管理网站数据"
5. 点击"移除全部"
6. 确认并关闭
7. 刷新页面

### 方案三：使用无痕/隐私模式

#### Chrome / Edge
- 按 `Ctrl + Shift + N`（Windows）或 `Cmd + Shift + N`（Mac）
- 在无痕窗口中访问：https://crm.andejiazheng.com/customers

#### Firefox
- 按 `Ctrl + Shift + P`（Windows）或 `Cmd + Shift + P`（Mac）
- 在隐私窗口中访问：https://crm.andejiazheng.com/customers

#### Safari
- 按 `Cmd + Shift + N`
- 在隐私浏览窗口中访问：https://crm.andejiazheng.com/customers

### 方案四：清除特定网站的缓存

#### Chrome / Edge

1. 打开开发者工具：按 `F12`
2. 右键点击刷新按钮（地址栏旁边）
3. 选择"清空缓存并硬性重新加载"

#### Firefox

1. 打开开发者工具：按 `F12`
2. 点击"网络"标签
3. 右键点击任意请求
4. 选择"清除浏览器缓存"

## 📋 验证步骤

清除缓存后，请按以下步骤验证：

1. ✅ 访问客户列表页面：https://crm.andejiazheng.com/customers
2. ✅ 点击"线索归属人"下拉框
3. ✅ 确认看到以下管理员用户：
   - 孙学博 (admin)
   - 孙学博 (sunxuebo)
   - 孙学鑫 (sunxuexin)
   - 朱小双 (zhuxiaoshuang)
   - 梁云东 (liangyundong)
   - 程聪 (chengcong)
   - 闫凯欣 (yankaixin)

## 🔍 如何确认缓存已清除

### 方法一：查看网络请求

1. 打开开发者工具（F12）
2. 切换到"网络"（Network）标签
3. 刷新页面
4. 找到 `assignable-users` 请求
5. 查看响应数据，确认包含管理员

### 方法二：查看控制台

1. 打开开发者工具（F12）
2. 切换到"控制台"（Console）标签
3. 输入以下代码并回车：
```javascript
fetch('/api/customers/assignable-users', {
  headers: {
    'Authorization': 'Bearer ' + localStorage.getItem('token')
  }
})
.then(r => r.json())
.then(d => console.table(d.data))
```
4. 查看输出的表格，确认包含管理员

## 🚀 后端已确认正常

- ✅ 后端代码已更新（包含 admin 角色）
- ✅ 后端服务已重启
- ✅ 数据库查询测试通过（返回13个用户，包括7个管理员）
- ✅ API端点正常工作

## 📞 如果问题仍然存在

如果清除缓存后问题仍然存在，请：

1. 尝试使用不同的浏览器
2. 检查浏览器控制台是否有错误信息
3. 检查网络请求是否成功
4. 联系技术支持

## 📌 预防措施

为避免将来出现类似问题，建议：

1. **定期清除缓存**：每周清除一次浏览器缓存
2. **使用强制刷新**：更新后使用 Ctrl+Shift+R 强制刷新
3. **禁用缓存**（开发环境）：
   - 打开开发者工具（F12）
   - 切换到"网络"标签
   - 勾选"禁用缓存"

---

**文档创建时间**: 2025-11-20 10:42
**问题状态**: ✅ 后端已修复，需要清除浏览器缓存

