<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è°ƒè¯•æ§åˆ¶å°</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: monospace;
      background: #000;
      color: #0f0;
    }
    #logs {
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .error { color: #f00; }
    .warn { color: #ff0; }
    .info { color: #0ff; }
  </style>
</head>
<body>
  <h2>ğŸ” H5 è°ƒè¯•æ§åˆ¶å°</h2>
  <div id="logs"></div>

  <script>
    const logsDiv = document.getElementById('logs');
    
    function addLog(message, type = 'info') {
      const time = new Date().toLocaleTimeString();
      const log = document.createElement('div');
      log.className = type;
      log.textContent = `[${time}] ${message}`;
      logsDiv.appendChild(log);
      logsDiv.scrollTop = logsDiv.scrollHeight;
    }

    // æ‹¦æˆª console
    const originalLog = console.log;
    const originalError = console.error;
    const originalWarn = console.warn;

    console.log = function(...args) {
      originalLog.apply(console, args);
      addLog(args.join(' '), 'info');
    };

    console.error = function(...args) {
      originalError.apply(console, args);
      addLog(args.join(' '), 'error');
    };

    console.warn = function(...args) {
      originalWarn.apply(console, args);
      addLog(args.join(' '), 'warn');
    };

    // æ‹¦æˆªæœªæ•è·çš„é”™è¯¯
    window.addEventListener('error', (e) => {
      addLog(`âŒ æœªæ•è·é”™è¯¯: ${e.message} at ${e.filename}:${e.lineno}`, 'error');
    });

    window.addEventListener('unhandledrejection', (e) => {
      addLog(`âŒ æœªå¤„ç†çš„ Promise æ‹’ç»: ${e.reason}`, 'error');
    });

    // è·å– URL å‚æ•°
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get('token');
    const targetUrl = urlParams.get('url');

    addLog('ğŸ” è°ƒè¯•æ§åˆ¶å°å·²å¯åŠ¨');
    addLog(`Token: ${token ? 'âœ… å·²æä¾›' : 'âŒ æœªæä¾›'}`);
    addLog(`ç›®æ ‡URL: ${targetUrl || 'æœªæŒ‡å®š'}`);

    if (targetUrl) {
      addLog(`â³ 3ç§’åå°†è·³è½¬åˆ°ç›®æ ‡é¡µé¢...`);
      setTimeout(() => {
        let url = targetUrl;
        if (token) {
          url += (url.includes('?') ? '&' : '?') + `token=${encodeURIComponent(token)}`;
        }
        addLog(`ğŸ”— è·³è½¬åˆ°: ${url}`);
        window.location.href = url;
      }, 3000);
    } else {
      addLog('âš ï¸ æœªæŒ‡å®šç›®æ ‡URLï¼Œè¯·åœ¨URLå‚æ•°ä¸­æ·»åŠ  ?url=ç›®æ ‡é¡µé¢åœ°å€');
    }
  </script>
</body>
</html>

