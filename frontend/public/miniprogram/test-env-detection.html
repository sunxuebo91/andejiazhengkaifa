<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ç¯å¢ƒæ£€æµ‹æµ‹è¯•</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
      margin-bottom: 20px;
    }
    .info-item {
      padding: 12px;
      margin: 10px 0;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #5fb3a3;
    }
    .info-label {
      font-weight: bold;
      color: #666;
      margin-bottom: 5px;
    }
    .info-value {
      color: #333;
      word-break: break-all;
    }
    .status {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: bold;
    }
    .status.yes {
      background: #d4edda;
      color: #155724;
    }
    .status.no {
      background: #f8d7da;
      color: #721c24;
    }
    .test-button {
      width: 100%;
      padding: 15px;
      margin: 10px 0;
      background: linear-gradient(135deg, #5fb3a3 0%, #4a9d8e 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .test-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(95, 179, 163, 0.3);
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” å¾®ä¿¡ç¯å¢ƒæ£€æµ‹æµ‹è¯•</h1>
    
    <div class="info-item">
      <div class="info-label">æ˜¯å¦åœ¨å¾®ä¿¡ä¸­ï¼š</div>
      <div class="info-value" id="isWechat"></div>
    </div>

    <div class="info-item">
      <div class="info-label">æ˜¯å¦åœ¨å°ç¨‹åº WebView ä¸­ï¼š</div>
      <div class="info-value" id="isMiniProgram"></div>
    </div>

    <div class="info-item">
      <div class="info-label">window.__wxjs_environmentï¼š</div>
      <div class="info-value" id="wxjsEnv"></div>
    </div>

    <div class="info-item">
      <div class="info-label">UserAgentï¼š</div>
      <div class="info-value" id="userAgent"></div>
    </div>

    <div class="info-item">
      <div class="info-label">UserAgent åŒ…å« miniProgramï¼š</div>
      <div class="info-value" id="uaContainsMiniProgram"></div>
    </div>

    <button class="test-button" onclick="testInvite()">æµ‹è¯•é‚€è¯·åŠŸèƒ½</button>
    <button class="test-button" onclick="testWxAPI()">æµ‹è¯•å¾®ä¿¡ JSSDK</button>
  </div>

  <script>
    // æ£€æµ‹æ˜¯å¦åœ¨å¾®ä¿¡ä¸­
    function isWechat() {
      return /MicroMessenger/i.test(navigator.userAgent);
    }

    // æ£€æµ‹æ˜¯å¦åœ¨å°ç¨‹åº WebView ä¸­
    function isInMiniProgram() {
      // æ–¹æ³•1ï¼šé€šè¿‡ window.__wxjs_environment åˆ¤æ–­
      if (window.__wxjs_environment === 'miniprogram') {
        return true;
      }
      
      // æ–¹æ³•2ï¼šé€šè¿‡ userAgent åˆ¤æ–­
      if (/miniProgram/i.test(navigator.userAgent)) {
        return true;
      }
      
      return false;
    }

    // æ˜¾ç¤ºæ£€æµ‹ç»“æœ
    function displayResults() {
      const isWx = isWechat();
      const isMini = isInMiniProgram();
      
      document.getElementById('isWechat').innerHTML = 
        `<span class="status ${isWx ? 'yes' : 'no'}">${isWx ? 'æ˜¯' : 'å¦'}</span>`;
      
      document.getElementById('isMiniProgram').innerHTML = 
        `<span class="status ${isMini ? 'yes' : 'no'}">${isMini ? 'æ˜¯' : 'å¦'}</span>`;
      
      document.getElementById('wxjsEnv').textContent = 
        window.__wxjs_environment || '(æœªå®šä¹‰)';
      
      document.getElementById('userAgent').textContent = 
        navigator.userAgent;
      
      const uaHasMiniProgram = /miniProgram/i.test(navigator.userAgent);
      document.getElementById('uaContainsMiniProgram').innerHTML = 
        `<span class="status ${uaHasMiniProgram ? 'yes' : 'no'}">${uaHasMiniProgram ? 'æ˜¯' : 'å¦'}</span>`;
    }

    // æµ‹è¯•é‚€è¯·åŠŸèƒ½
    function testInvite() {
      if (isInMiniProgram()) {
        alert('å°ç¨‹åºç¯å¢ƒï¼šè¯·ç‚¹å‡»å³ä¸Šè§’"..."æŒ‰é’®ï¼Œé€‰æ‹©"è½¬å‘"åˆ†äº«');
      } else {
        alert('æµè§ˆå™¨ç¯å¢ƒï¼šæ˜¾ç¤ºé‚€è¯·é“¾æ¥å¼¹çª—');
      }
    }

    // æµ‹è¯•å¾®ä¿¡ JSSDK
    function testWxAPI() {
      if (typeof wx !== 'undefined' && wx.miniProgram) {
        wx.miniProgram.getEnv(function(res) {
          alert('wx.miniProgram.getEnv ç»“æœï¼š' + JSON.stringify(res));
        });
      } else {
        alert('wx.miniProgram ä¸å¯ç”¨ï¼ˆéå°ç¨‹åºç¯å¢ƒï¼‰');
      }
    }

    // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºç»“æœ
    window.onload = displayResults;
  </script>
</body>
</html>

