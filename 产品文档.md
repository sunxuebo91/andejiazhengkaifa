# 安得家政 CRM 系统 - 产品文档

> 文档版本：v2.0  
> 最后更新：2025-02-27  
> 适用系统：安得家政 CRM 全功能版本

---

## 目录

1. [产品概述](#1-产品概述)
2. [系统架构](#2-系统架构)
3. [核心功能模块](#3-核心功能模块)
4. [小程序端功能](#4-小程序端功能)
5. [第三方服务集成](#5-第三方服务集成)
6. [数据安全与合规](#6-数据安全与合规)
7. [部署与运维](#7-部署与运维)
8. [使用指南](#8-使用指南)
9. [版本历史](#9-版本历史)

---

## 1. 产品概述

### 1.1 产品简介

安得家政 CRM 系统是一款专为家政服务行业打造的现代化客户关系管理平台。系统采用前后端分离架构，集成了客户管理、简历管理、合同管理、视频面试、保险管理等核心功能模块，帮助家政企业实现业务流程数字化、智能化管理。

系统支持多端访问：
- **CRM Web 端**：面向企业内部员工，提供完整的业务管理功能
- **微信小程序端**：面向客户和阿姨，提供便捷的服务入口
- **H5 页面**：视频面试专用页面，支持跨平台访问

### 1.2 核心价值

| 价值点 | 详细说明 |
|-------|---------|
| **全流程数字化** | 覆盖从线索获取、客户跟进、阿姨匹配、合同签署到售后服务的全业务流程，消除纸质单据，提升业务效率 50%+ |
| **智能化匹配** | 基于技能标签、工作经验、服务区域、档期状态、客户评价等多维度算法，实现阿姨与客户的精准匹配，匹配成功率提升 30% |
| **高效协同** | 支持多角色（管理员、经理、顾问）协同工作，客户资源合理分配，避免撞单和遗漏，团队协作效率提升 40% |
| **合规保障** | 集成爱签电子签约、大树保保险等第三方服务，确保合同签署合法有效、服务过程风险可控 |
| **数据驱动** | 提供客户转化率、阿姨活跃度、合同成交率、员工业绩等多维度数据分析报表，辅助经营决策 |

### 1.3 目标用户

| 用户角色 | 主要职责 | 使用场景 | 使用端 |
|---------|---------|---------|-------|
| **系统管理员** | 系统配置、用户管理、权限分配、数据备份 | 系统初始化、日常运维、权限调整 | CRM Web |
| **经理/主管** | 团队管理、客户分配、业绩监控、数据分析 | 客户分配、团队管理、查看报表 | CRM Web |
| **家政顾问** | 客户跟进、阿姨匹配、合同签署、售后服务 | 日常业务操作、客户维护 | CRM Web |
| **阿姨（服务人员）** | 简历维护、档期管理、接单服务、参与面试 | 简历更新、设置接单状态、视频面试 | 小程序 |
| **客户** | 需求发布、阿姨筛选、面试预约、合同查看 | 发布需求、筛选阿姨、签约服务 | 小程序 |

### 1.4 业务场景

#### 场景一：新客户转化
```
客户咨询 → 录入系统 → 分配顾问 → 需求分析 → 匹配阿姨 → 视频面试 → 签约成交 → 售后服务
```

#### 场景二：阿姨入职
```
阿姨注册 → 填写简历 → 上传证书 → 资质审核 → 上架展示 → 接受匹配 → 参加面试 → 签约上户
```

#### 场景三：合同换人
```
客户申请换人 → 确认原因 → 匹配新阿姨 → 客户面试 → 生成补充协议 → 双方签署 → 原合同归档 → 新合同生效
```

---

## 2. 系统架构

### 2.1 整体架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              接入层 (Access Layer)                           │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────────────────┐  │
│  │   PC 浏览器      │  │   微信浏览器     │  │      微信小程序             │  │
│  │  (Chrome/Edge)  │  │   (公众号/H5)   │  │    (客户端/阿姨端)          │  │
│  └────────┬────────┘  └────────┬────────┘  └─────────────┬─────────────────┘  │
│           │                    │                          │                   │
│           └────────────────────┼──────────────────────────┘                   │
│                                │                                              │
│                                ▼                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        CDN 加速层 (腾讯云 CDN)                           │ │
│  │              静态资源缓存、图片加速、视频加速、HTTPS 证书管理              │ │
│  └─────────────────────────────────────┬───────────────────────────────────┘ │
└────────────────────────────────────────┼─────────────────────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                           网关层 (Gateway Layer)                             │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │                          Nginx 反向代理                                  ││
│  │  • SSL 终止  • 负载均衡  • 静态资源服务  • 请求路由  • 限流保护          ││
│  └─────────────────────────────────────┬───────────────────────────────────┘│
└────────────────────────────────────────┼────────────────────────────────────┘
                                         │
                    ┌────────────────────┼────────────────────┐
                    │                    │                    │
                    ▼                    ▼                    ▼
┌─────────────────────────┐  ┌─────────────────────────┐  ┌─────────────────────┐
│      前端服务层          │  │      后端 API 层         │  │     数据存储层       │
│  ┌─────────────────┐   │  │  ┌─────────────────┐   │  │  ┌─────────────┐   │
│  │   React SPA     │   │  │  │   NestJS API    │   │  │  │   MongoDB   │   │
│  │   (Vite构建)    │   │  │  │   (Node.js)     │   │  │  │  (主从副本)  │   │
│  │                 │   │  │  │                 │   │  │  │             │   │
│  │  • 客户管理模块  │   │  │  │  • 业务逻辑处理  │   │  │  • 业务数据   │   │
│  │  • 简历管理模块  │   │  │  │  • 权限控制     │   │  │  • 用户数据   │   │
│  │  • 合同管理模块  │   │  │  │  • 数据校验     │   │  │  • 日志数据   │   │
│  │  • 视频面试模块  │   │  │  │  • 接口聚合     │   │  │             │   │
│  │  • 保险管理模块  │   │  │  │                 │   │  │             │   │
│  └─────────────────┘   │  │  └─────────────────┘   │  │  └─────────────┘   │
│         Port: 4173      │  │         Port: 3000      │  │       Port: 27017  │
│       (PM2 集群部署)    │  │       (PM2 集群部署)    │  │    (副本集部署)    │
└─────────────────────────┘  └─────────────────────────┘  └─────────────────────┘
                                         │
                                         ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                         第三方服务集成层 (Integration)                        │
│  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────┐ │
│  │   爱签     │  │  大树保    │  │   ZEGO     │  │  腾讯云    │  │  微信   │ │
│  │ 电子签约   │  │  保险平台  │  │  音视频    │  │ OCR/COS    │  │ 生态    │ │
│  └────────────┘  └────────────┘  └────────────┘  └────────────┘  └────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 技术栈详解

#### 2.2.1 前端技术栈

| 技术/框架 | 版本 | 用途 | 选型理由 |
|----------|------|------|---------|
| **React** | 18.x | UI 框架 | 组件化开发，生态丰富，性能优秀 |
| **TypeScript** | 5.x | 类型系统 | 静态类型检查，提升代码质量和可维护性 |
| **Vite** | 5.x | 构建工具 | 极速冷启动，热更新，优化构建产物 |
| **Ant Design** | 5.x | UI 组件库 | 企业级设计规范，组件丰富，文档完善 |
| **Redux Toolkit** | 2.x | 状态管理 | 简化 Redux 使用，内置最佳实践 |
| **React Router** | 6.x | 路由管理 | 声明式路由，支持嵌套路由和懒加载 |
| **Axios** | 1.x | HTTP 客户端 | 拦截器支持，请求/响应处理便捷 |
| **Day.js** | 1.x | 日期处理 | 轻量级，API 兼容 Moment.js |
| **Socket.IO Client** | 4.x | 实时通信 | WebSocket 封装，自动重连 |

#### 2.2.2 后端技术栈

| 技术/框架 | 版本 | 用途 | 选型理由 |
|----------|------|------|---------|
| **NestJS** | 10.x | 后端框架 | 模块化架构，依赖注入，企业级设计 |
| **Node.js** | 18.x LTS | 运行环境 | 长期支持版本，性能稳定 |
| **MongoDB** | 6.x | 数据库 | 文档型数据库，灵活的数据模型 |
| **Mongoose** | 8.x | ODM 框架 | 数据建模，验证，中间件支持 |
| **JWT** | 9.x | 认证机制 | 无状态认证，支持跨域 |
| **Passport** | 0.6.x | 认证中间件 | 多种认证策略支持 |
| **Socket.IO** | 4.x | 实时通信 | WebSocket 服务，房间管理 |
| **Swagger** | 7.x | API 文档 | 自动生成 OpenAPI 文档 |
| **Winston** | 3.x | 日志框架 | 多传输通道，日志分级 |

#### 2.2.3 运维技术栈

| 技术/工具 | 用途 | 说明 |
|----------|------|------|
| **Nginx** | 反向代理、负载均衡 | SSL 终止，静态资源服务 |
| **PM2** | 进程管理 | Node.js 集群部署，自动重启 |
| **MongoDB Replica Set** | 数据库高可用 | 一主两从，自动故障转移 |
| **腾讯云 CDN** | 内容分发 | 静态资源加速，图片视频优化 |
| **腾讯云 COS** | 对象存储 | 文件存储，CDN 集成 |

### 2.3 系统部署架构

#### 2.3.1 生产环境部署

```
                                    互联网
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              腾讯云 CDN                                     │
│                    (静态资源加速、HTTPS证书、DDoS防护)                        │
└─────────────────────────────────────────┬───────────────────────────────────┘
                                          │
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              云服务器集群                                    │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │                           Nginx 负载均衡                                 ││
│  │                     (SSL终止、请求分发、限流保护)                         ││
│  └───────────────────────────────┬─────────────────────────────────────────┘│
│                                  │                                          │
│         ┌────────────────────────┼────────────────────────┐                 │
│         │                        │                        │                 │
│         ▼                        ▼                        ▼                 │
│  ┌─────────────┐          ┌─────────────┐          ┌─────────────┐         │
│  │  前端服务-1  │          │  前端服务-2  │          │  前端服务-N  │         │
│  │  (PM2实例)  │          │  (PM2实例)  │          │  (PM2实例)  │         │
│  │  Port:4173  │          │  Port:4173  │          │  Port:4173  │         │
│  └─────────────┘          └─────────────┘          └─────────────┘         │
│                                                                         │
│  ┌─────────────┐          ┌─────────────┐          ┌─────────────┐         │
│  │  后端服务-1  │          │  后端服务-2  │          │  后端服务-N  │         │
│  │  (PM2实例)  │          │  (PM2实例)  │          │  (PM2实例)  │         │
│  │  Port:3000  │          │  Port:3000  │          │  Port:3000  │         │
│  └─────────────┘          └─────────────┘          └─────────────┘         │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────────┘
                                          │
                                          ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            MongoDB 副本集                                   │
│  ┌─────────────┐      ┌─────────────┐      ┌─────────────┐                 │
│  │   Primary   │◀────▶│  Secondary  │◀────▶│  Secondary  │                 │
│  │  (主节点)   │      │  (从节点)   │      │  (从节点)   │                 │
│  │  Port:27017 │      │  Port:27017 │      │  Port:27017 │                 │
│  └─────────────┘      └─────────────┘      └─────────────┘                 │
│       ▲                                                                    │
│       └────────────────────────────────────────────────────────────────    │
│                              自动故障转移                                   │
└─────────────────────────────────────────────────────────────────────────────┘
```

#### 2.3.2 环境配置

| 环境 | 用途 | 配置 |
|-----|------|------|
| **开发环境** | 本地开发调试 | 单机部署，热更新 |
| **测试环境** | 功能测试验收 | 单实例部署，模拟生产 |
| **生产环境** | 正式业务运行 | 集群部署，高可用配置 |

### 2.4 数据流架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              数据流向图                                      │
└─────────────────────────────────────────────────────────────────────────────┘

用户操作 (Web/小程序)
         │
         ▼
┌─────────────────┐
│   API 请求      │
│  (REST/WebSocket)│
└────────┬────────┘
         │
         ▼
┌─────────────────┐     ┌─────────────────┐
│   认证鉴权       │────▶│   JWT 验证      │
│  (Auth Guard)   │     │  (Token校验)    │
└────────┬────────┘     └─────────────────┘
         │
         ▼
┌─────────────────┐
│   业务处理       │
│  (Controller)   │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   业务逻辑       │
│   (Service)     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐     ┌─────────────────┐
│   数据访问       │────▶│   MongoDB       │
│  (Repository)   │     │  (数据持久化)    │
└────────┬────────┘     └─────────────────┘
         │
         ▼
┌─────────────────┐     ┌─────────────────┐
│   第三方调用     │────▶│  爱签/大树保/ZEGO│
│ (Integration)   │     │  (外部服务)     │
└────────┬────────┘     └─────────────────┘
         │
         ▼
┌─────────────────┐
│   响应返回       │
│  (JSON/WebSocket)│
└─────────────────┘
```

---

## 3. 核心功能模块

### 3.1 客户管理模块

#### 3.1.1 模块概述

客户管理是 CRM 系统的核心模块，提供从线索获取到成交转化的全流程管理。支持多渠道线索导入、智能分配、跟进记录、公海管理等功能。

**业务目标**：
- 提升客户转化率
- 规范跟进流程
- 避免客户资源浪费
- 实现数据可追溯

#### 3.1.2 客户数据模型

| 字段分组 | 字段名称 | 数据类型 | 必填 | 说明 |
|---------|---------|---------|------|------|
| **基础信息** | _id | ObjectId | 是 | 系统唯一标识 |
| | name | String | 是 | 客户姓名 |
| | phone | String | 条件 | 手机号（phone/wechatId 至少填一个）|
| | wechatId | String | 条件 | 微信号 |
| | gender | Enum | 否 | 性别：male/female |
| | age | Number | 否 | 年龄 |
| **需求信息** | serviceType | Enum | 否 | 服务类型：月嫂/育儿嫂/保姆/钟点工/养老护理 |
| | serviceArea | String | 否 | 服务区域 |
| | budgetMin | Number | 否 | 预算下限 |
| | budgetMax | Number | 否 | 预算上限 |
| | expectedDate | Date | 否 | 期望服务时间 |
| | requirements | String | 否 | 详细需求描述 |
| **地址信息** | address | String | 否 | 详细地址 |
| | district | String | 否 | 区县 |
| | city | String | 否 | 城市 |
| **来源信息** | leadSource | Enum | 否 | 线索来源 |
| | leadLevel | Enum | 否 | 线索等级：A/B/C/D/O/X |
| | channel | String | 否 | 渠道标识 |
| **状态信息** | contractStatus | Enum | 否 | 合同状态 |
| | followUpStatus | Enum | 否 | 跟进状态 |
| | lastFollowUpTime | Date | 否 | 最后跟进时间 |
| **归属信息** | assignedTo | ObjectId | 否 | 负责人ID |
| | assignedBy | ObjectId | 否 | 分配人ID |
| | assignedAt | Date | 否 | 分配时间 |
| | inPublicPool | Boolean | 否 | 是否在公海 |
| **系统字段** | createdBy | ObjectId | 是 | 创建人ID |
| | createdAt | Date | 是 | 创建时间 |
| | updatedAt | Date | 是 | 更新时间 |
| | lastUpdatedBy | ObjectId | 否 | 最后更新人 |

#### 3.1.3 客户等级体系详解

| 等级 | 名称 | 定义标准 | 跟进要求 | 转化目标 |
|-----|------|---------|---------|---------|
| **A** | 重点客户 | 需求明确、预算充足、7天内可成交 | 每日跟进，记录沟通详情 | 7天内签约 |
| **B** | 意向客户 | 有明确需求、正在比较、30天内可能成交 | 2-3天跟进，提供方案 | 30天内签约 |
| **C** | 潜在客户 | 有需求但时间未定、需要培育 | 每周跟进，保持联系 | 90天内转化 |
| **D** | 长期培育 | 需求模糊、长期关注、时机不成熟 | 每月触达，发送资讯 | 持续培育 |
| **O** | 成交客户 | 已签约、服务中或服务完成 | 服务跟进，维护关系 | 续签/转介绍 |
| **X** | 流失客户 | 明确拒绝、无法联系、需求取消 | 暂停跟进，定期唤醒 | 唤醒转化 |

#### 3.1.4 线索来源分类

| 来源类型 | 说明 | 示例 |
|---------|------|------|
| **自然流量** | 客户主动咨询 | 官网、400电话、门店 |
| **付费推广** | 广告投放获取 | 百度推广、信息流广告 |
| **社群运营** | 社群转化 | 微信群、QQ群 |
| **地推活动** | 线下推广 | 社区活动、展会 |
| **转介绍** | 老客户推荐 | 口碑传播 |
| **合单合作** | 合作伙伴推荐 | 异业合作 |
| **其他** | 其他渠道 | 未分类来源 |

#### 3.1.5 公海管理机制

**自动进入公海规则**：
| 规则 | 条件 | 执行动作 |
|-----|------|---------|
| 跟进超时 | 超过 7 天无跟进记录 | 自动释放到公海 |
| 长期未成交 | B级客户超过 30 天未成交 | 提醒后释放 |
| 客户拒绝 | 客户明确拒绝服务 | 标记为X级，可释放 |

**公海领取规则**：
| 规则 | 说明 |
|-----|------|
| 领取上限 | 每个员工最多持有 50 个客户 |
| 领取限制 | 24小时内需完成首次跟进 |
| 领取记录 | 记录领取人、领取时间 |
| 防重复领取 | 同一客户不能被重复领取 |

**公海分配规则**：
| 角色 | 权限 | 操作 |
|-----|------|------|
| 管理员 | 批量分配 | 从公海批量分配客户给员工 |
| 经理 | 团队分配 | 分配给本团队员工 |
| 员工 | 自主领取 | 从公海领取客户 |

#### 3.1.6 跟进记录管理

**跟进类型**：
| 类型 | 说明 | 适用场景 |
|-----|------|---------|
| **电话沟通** | 电话/语音沟通 | 日常跟进、需求确认 |
| **微信沟通** | 微信文字/语音 | 日常维护、资料发送 |
| **到店沟通** | 客户到店面谈 | 深度沟通、签约准备 |
| **面试沟通** | 安排阿姨面试 | 匹配推荐后的面试 |
| **其他** | 其他沟通方式 | 邮件、短信等 |

**跟进记录字段**：
| 字段 | 类型 | 说明 |
|-----|------|------|
| customerId | ObjectId | 关联客户ID |
| type | Enum | 跟进类型 |
| content | String | 跟进内容 |
| nextFollowUpTime | Date | 下次跟进时间 |
| nextFollowUpContent | String | 下次跟进计划 |
| createdBy | ObjectId | 跟进人 |
| createdAt | Date | 跟进时间 |

#### 3.1.7 客户分配流程

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  客户录入   │───▶│  客户分配   │───▶│  通知推送   │───▶│  跟进转化   │
│(手动/导入)  │    │(自动/手动)  │    │(站内/微信)  │    │(签约成交)   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       │                  │                  │                  │
       ▼                  ▼                  ▼                  ▼
  • 信息录入         • 按规则分配        • 站内信通知       • 添加跟进
  • 数据校验         • 负载均衡          • 微信推送         • 匹配阿姨
  • 重复检测         • 权限检查          • 短信通知         • 签约转化
```

**分配策略**：
| 策略 | 说明 | 适用场景 |
|-----|------|---------|
| **轮询分配** | 按顺序轮流分配给顾问 | 新线索自动分配 |
| **负载均衡** | 根据顾问当前客户数分配 | 平衡工作量 |
| **能力匹配** | 根据顾问专长分配 | 专业客户 |
| **手动分配** | 管理员/经理手动指定 | 重点客户 |

#### 3.1.8 核心功能清单

| 功能模块 | 功能点 | 功能描述 | 适用角色 |
|---------|-------|---------|---------|
| **客户列表** | 列表展示 | 分页展示客户列表，支持排序 | 全员 |
| | 高级筛选 | 多维度筛选：等级、状态、来源、时间 | 全员 |
| | 搜索查询 | 按姓名、手机号、微信号搜索 | 全员 |
| | 批量操作 | 批量分配、批量释放、批量导出 | 管理员/经理 |
| | 列表导出 | 导出Excel | 管理员 |
| **客户详情** | 信息展示 | 展示客户完整信息 | 全员 |
| | 跟进记录 | 查看历史跟进记录 | 全员 |
| | 操作日志 | 查看客户操作历史 | 全员 |
| | 分配历史 | 查看客户分配流转记录 | 全员 |
| | 关联合同 | 查看客户相关合同 | 全员 |
| **客户录入** | 手动录入 | 表单录入客户信息 | 全员 |
| | 批量导入 | Excel批量导入 | 管理员 |
| | 重复检测 | 检测手机号/微信是否重复 | 全员 |
| | 智能填充 | 根据手机号自动填充历史信息 | 全员 |
| **客户分配** | 单条分配 | 单个客户分配给指定顾问 | 管理员/经理 |
| | 批量分配 | 批量客户分配 | 管理员/经理 |
| | 公海领取 | 从公海领取客户 | 员工 |
| | 转移客户 | 变更客户负责人 | 管理员/经理 |
| **公海管理** | 公海列表 | 查看公海客户 | 全员 |
| | 公海统计 | 公海数据统计 | 管理员/经理 |
| | 领取记录 | 查看领取历史 | 管理员 |
| **跟进管理** | 添加跟进 | 记录跟进内容 | 全员 |
| | 跟进提醒 | 到期跟进提醒 | 全员 |
| | 跟进统计 | 个人/团队跟进统计 | 管理员/经理 |

#### 3.1.9 API 接口列表

| 接口 | 方法 | 路径 | 说明 |
|-----|------|------|------|
| 获取客户列表 | GET | /api/customers | 支持分页、筛选、排序 |
| 获取客户详情 | GET | /api/customers/:id | 包含跟进记录、分配历史 |
| 创建客户 | POST | /api/customers | 新建客户 |
| 更新客户 | PATCH | /api/customers/:id | 更新客户信息 |
| 删除客户 | DELETE | /api/customers/:id | 删除客户（软删除）|
| 分配客户 | POST | /api/customers/:id/assign | 分配给客户顾问 |
| 批量分配 | POST | /api/customers/batch-assign | 批量分配客户 |
| 释放到公海 | POST | /api/customers/:id/release-to-pool | 释放客户到公海 |
| 批量释放 | POST | /api/customers/batch-release-to-pool | 批量释放到公海 |
| 领取客户 | POST | /api/customers/public-pool/claim | 从公海领取客户 |
| 获取公海列表 | GET | /api/customers/public-pool | 获取公海客户列表 |
| 添加跟进 | POST | /api/customers/:id/follow-ups | 添加跟进记录 |
| 获取跟进记录 | GET | /api/customers/:id/follow-ups | 获取客户跟进记录 |
| 导入客户 | POST | /api/customers/import | Excel导入客户 |
| 导出客户 | GET | /api/customers/export | 导出客户数据 |

---

### 3.2 简历管理模块

#### 3.2.1 模块概述

简历管理模块用于管理家政服务人员（阿姨）的档案信息，包括基本信息、技能证书、工作经历、档期管理等。支持员工创建和阿姨自助注册两种模式。

**业务目标**：
- 建立完善的阿姨档案库
- 实现阿姨信息标准化管理
- 支持智能匹配推荐
- 提供阿姨自助服务入口

#### 3.2.2 简历数据模型

| 字段分组 | 字段名称 | 数据类型 | 必填 | 说明 |
|---------|---------|---------|------|------|
| **基础信息** | _id | ObjectId | 是 | 系统唯一标识 |
| | name | String | 是 | 姓名 |
| | phone | String | 是 | 手机号 |
| | idNumber | String | 是 | 身份证号 |
| | gender | Enum | 是 | 性别：male/female |
| | birthDate | Date | 是 | 出生日期 |
| | age | Number | 否 | 年龄（自动计算）|
| | ethnicity | String | 否 | 民族 |
| | nativePlace | String | 否 | 籍贯 |
| | maritalStatus | Enum | 否 | 婚姻状况 |
| | religion | Enum | 否 | 宗教信仰 |
| **工作信息** | jobType | Enum | 是 | 工种：月嫂/育儿嫂/保姆/钟点工/养老护理 |
| | experienceYears | Number | 否 | 工作经验年限 |
| | expectedSalary | Number | 否 | 期望薪资 |
| | serviceArea | String | 否 | 服务区域 |
| | orderStatus | Enum | 否 | 接单状态：待业/在职/暂不接单 |
| **技能信息** | skills | Array | 否 | 技能标签数组 |
| | certificates | Array | 否 | 证书信息数组 |
| **档期信息** | availability | Object | 否 | 档期可用时间 |
| | currentOrder | ObjectId | 否 | 当前订单ID |
| **文件信息** | idCardFront | Object | 否 | 身份证正面 |
| | idCardBack | Object | 否 | 身份证背面 |
| | personalPhoto | Array | 否 | 个人照片数组 |
| | certificateFiles | Array | 否 | 证书文件数组 |
| | medicalReport | Object | 否 | 体检报告 |
| **评价信息** | employeeEvaluations | Array | 否 | 员工评价数组 |
| | customerReviews | Array | 否 | 客户评价数组 |
| **来源信息** | leadSource | Enum | 否 | 来源渠道 |
| | userId | ObjectId | 否 | 创建员工ID（null表示自助注册）|
| **系统字段** | createdAt | Date | 是 | 创建时间 |
| | updatedAt | Date | 是 | 更新时间 |
| | lastUpdatedBy | ObjectId | 否 | 最后更新人 |

#### 3.2.3 工种分类详解

| 工种 | 服务对象 | 主要职责 | 技能要求 | 薪资范围 |
|-----|---------|---------|---------|---------|
| **月嫂** | 产妇+新生儿 | 产妇护理、新生儿照护、月子餐制作 | 母婴护理师证、催乳师证、产后修复师证 | 8000-20000元/月 |
| **育儿嫂** | 0-3岁婴幼儿 | 婴幼儿照护、辅食制作、早期教育 | 育婴师证、早教师证、小儿推拿师证 | 6000-12000元/月 |
| **保姆** | 家庭日常 | 家务料理、老人陪护、烹饪 | 家政服务经验、烹饪技能 | 5000-8000元/月 |
| **钟点工** | 家庭日常 | 临时家务、保洁、做饭 | 灵活时间、就近服务 | 30-50元/小时 |
| **养老护理** | 老年人 | 生活照料、健康护理、康复辅助 | 养老护理证、护理经验 | 5000-8000元/月 |

#### 3.2.4 技能证书体系

**母婴护理类**：
| 证书名称 | 颁发机构 | 培训周期 | 重要性 |
|---------|---------|---------|-------|
| 母婴护理师（月嫂证）| 人社部/行业协会 | 15-30天 | 必备 |
| 高级催乳师 | 行业协会 | 7-15天 | 重要 |
| 产后修复师 | 行业协会 | 7-15天 | 加分 |
| 月子餐营养师 | 行业协会 | 3-7天 | 加分 |
| 特殊婴儿护理 | 专业机构 | 3-7天 | 特色 |

**婴幼儿护理类**：
| 证书名称 | 颁发机构 | 培训周期 | 重要性 |
|---------|---------|---------|-------|
| 高级育婴师 | 人社部 | 15-30天 | 必备 |
| 早教师 | 行业协会 | 7-15天 | 重要 |
| 小儿推拿师 | 行业协会 | 7-15天 | 加分 |
| 辅食营养师 | 行业协会 | 3-7天 | 加分 |

**家政服务类**：
| 证书名称 | 颁发机构 | 培训周期 | 重要性 |
|---------|---------|---------|-------|
| 家政服务员 | 人社部 | 7-15天 | 基础 |
| 整理收纳师 | 行业协会 | 3-7天 | 特色 |
| 营养师 | 人社部 | 15-30天 | 加分 |

**烹饪技能类**：
| 证书名称 | 说明 | 重要性 |
|---------|------|-------|
| 中餐烹饪 | 家常菜、地方菜 | 基础 |
| 西餐烹饪 | 西式简餐 | 加分 |
| 面食制作 | 各类面食 | 加分 |
| 月子餐制作 | 产妇营养餐 | 月嫂必备 |
| 辅食制作 | 婴幼儿辅食 | 育儿嫂必备 |

**特殊技能类**：
| 证书名称 | 说明 | 溢价能力 |
|---------|------|---------|
| 医疗背景 | 护士/护工经验 | +20-30% |
| 外语能力 | 英语/日语等 | +15-25% |
| 驾驶技能 | 驾照 | +10-15% |
| 双胎护理 | 双胞胎照护经验 | +15-20% |
| 理疗康复 | 康复护理技能 | +10-15% |

#### 3.2.5 接单状态管理

| 状态 | 说明 | 可匹配 | 状态变更条件 |
|-----|------|-------|-------------|
| **待业** | 可接单，等待匹配 | 是 | 默认状态，完成订单后自动变更 |
| **在职** | 正在服务中 | 否 | 签约后自动变更 |
| **暂不接单** | 暂时无法接受新订单 | 否 | 阿姨主动设置 |
| **已下架** | 已离开平台 | 否 | 离职/违规处理 |

#### 3.2.6 工作经历管理

**工作经历字段**：
| 字段 | 类型 | 说明 |
|-----|------|------|
| company | String | 服务家庭/公司名称 |
| position | String | 职位/工种 |
| startDate | Date | 开始日期 |
| endDate | Date | 结束日期 |
| description | String | 工作内容描述 |
| customerName | String | 客户姓名（脱敏）|
| customerReview | String | 客户评价 |
| photos | Array | 工作照片 |

#### 3.2.7 员工评价体系

**评价维度**：
| 维度 | 分值范围 | 说明 |
|-----|---------|------|
| **服务态度** | 1-5分 | 服务热情、耐心程度 |
| **专业技能** | 1-5分 | 专业技能水平 |
| **工作效率** | 1-5分 | 工作完成效率 |
| **沟通能力** | 1-5分 | 与客户沟通效果 |
| **综合评分** | 1-5分 | 整体评价 |

**评价类型**：
| 类型 | 说明 | 可见性 |
|-----|------|-------|
| **内部评价** | 员工对阿姨的评价 | 内部可见 |
| **客户评价** | 客户对阿姨的评价 | 脱敏后可见 |
| **培训评价** | 培训考核评价 | 内部可见 |

#### 3.2.8 核心功能清单

| 功能模块 | 功能点 | 功能描述 | 适用角色 |
|---------|-------|---------|---------|
| **简历列表** | 列表展示 | 分页展示简历列表 | 全员 |
| | 高级筛选 | 按工种、技能、区域、状态筛选 | 全员 |
| | 搜索查询 | 按姓名、手机号搜索 | 全员 |
| | 排序功能 | 按经验、薪资、评分排序 | 全员 |
| **简历详情** | 信息展示 | 展示完整简历信息 | 全员 |
| | 证件查看 | 查看身份证、证书照片 | 全员 |
| | 工作经历 | 查看历史工作经历 | 全员 |
| | 评价记录 | 查看员工/客户评价 | 全员 |
| | 档期日历 | 查看档期可用时间 | 全员 |
| **创建简历** | 表单录入 | 员工录入阿姨信息 | 员工 |
| | OCR识别 | 身份证自动识别填充 | 员工 |
| | 重复检测 | 检测身份证/手机号重复 | 员工 |
| **编辑简历** | 信息修改 | 修改阿姨基本信息 | 员工/阿姨 |
| | 照片上传 | 上传个人照片、工作照 | 员工/阿姨 |
| | 证书管理 | 上传技能证书 | 员工/阿姨 |
| | 档期设置 | 设置接单状态 | 员工/阿姨 |
| **自助注册** | 小程序注册 | 阿姨自助填写信息 | 阿姨 |
| | 微信授权 | 微信一键授权登录 | 阿姨 |
| | 信息完善 | 补充完善简历信息 | 阿姨 |
| **员工评价** | 添加评价 | 对员工进行评价 | 员工 |
| | 评价列表 | 查看历史评价 | 员工 |
| | 评价统计 | 查看阿姨评分统计 | 员工 |

#### 3.2.9 API 接口列表

| 接口 | 方法 | 路径 | 说明 |
|-----|------|------|------|
| 获取简历列表 | GET | /api/resumes | 支持分页、筛选 |
| 获取简历详情 | GET | /api/resumes/:id | 包含工作经历、评价 |
| 创建简历 | POST | /api/resumes | 创建新简历 |
| 更新简历 | PATCH | /api/resumes/:id | 更新简历信息 |
| 删除简历 | DELETE | /api/resumes/:id | 删除简历 |
| 上传证件照 | POST | /api/resumes/:id/upload | 上传证件照片 |
| 添加工作经历 | POST | /api/resumes/:id/work-experiences | 添加工作经历 |
| 添加员工评价 | POST | /api/employee-evaluations | 添加员工评价 |
| 自助注册 | POST | /api/resumes/miniprogram/self-register | 阿姨自助注册 |
| 搜索简历 | GET | /api/resumes/search | 搜索简历 |

---

### 3.3 合同管理模块

#### 3.3.1 模块概述

合同管理模块提供家政服务合同的全生命周期管理，包括合同创建、电子签约、换人管理、到期提醒等功能，与爱签电子签约平台深度集成。

**业务目标**：
- 规范合同签署流程
- 确保合同法律效力
- 支持合同变更管理
- 提供合同到期预警

#### 3.3.2 合同数据模型

| 字段分组 | 字段名称 | 数据类型 | 必填 | 说明 |
|---------|---------|---------|------|------|
| **合同信息** | _id | ObjectId | 是 | 系统唯一标识 |
| | contractNumber | String | 是 | 合同编号（系统自动生成）|
| | contractType | Enum | 是 | 合同类型 |
| | contractStatus | Enum | 是 | 合同状态 |
| | signDate | Date | 否 | 签约日期 |
| | startDate | Date | 是 | 服务开始日期 |
| | endDate | Date | 是 | 服务结束日期 |
| **客户信息** | customerId | ObjectId | 是 | 客户ID |
| | customerName | String | 是 | 客户姓名 |
| | customerPhone | String | 是 | 客户电话 |
| | customerIdCard | String | 是 | 客户身份证号 |
| **阿姨信息** | workerId | ObjectId | 是 | 阿姨ID |
| | workerName | String | 是 | 阿姨姓名 |
| | workerPhone | String | 是 | 阿姨电话 |
| | workerIdCard | String | 是 | 阿姨身份证号 |
| **服务信息** | serviceType | Enum | 是 | 服务类型 |
| | serviceAddress | String | 是 | 服务地址 |
| | serviceRequirements | String | 否 | 服务要求 |
| **费用信息** | workerSalary | Number | 是 | 阿姨工资 |
| | serviceFee | Number | 是 | 服务费 |
| | matchFee | Number | 否 | 匹配费 |
| | totalAmount | Number | 是 | 合同总金额 |
| **签约信息** | esignContractNo | String | 否 | 爱签合同编号 |
| | esignStatus | Enum | 否 | 签约状态 |
| | esignSignUrls | Array | 否 | 签署链接数组 |
| | esignCreatedAt | Date | 否 | 签约发起时间 |
| **换人信息** | isReplaced | Boolean | 否 | 是否已换人 |
| | originalContractId | ObjectId | 否 | 原合同ID（换人后）|
| | replacedAt | Date | 否 | 换人时间 |
| **系统字段** | createdBy | ObjectId | 是 | 创建人 |
| | createdAt | Date | 是 | 创建时间 |
| | updatedAt | Date | 是 | 更新时间 |

#### 3.3.3 合同类型

| 类型 | 说明 | 适用场景 | 期限 |
|-----|------|---------|------|
| **月嫂合同** | 产妇月子期间服务 | 月嫂服务 | 26-42天 |
| **育儿嫂合同** | 婴幼儿照护服务 | 育儿嫂服务 | 1-12个月 |
| **保姆合同** | 家务料理服务 | 住家/不住家保姆 | 1-12个月 |
| **钟点工合同** | 临时家务服务 | 钟点工服务 | 按小时/次 |
| **养老护理合同** | 老人照护服务 | 养老护理 | 1-12个月 |

#### 3.3.4 合同状态流转

```
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│  草稿    │───▶│ 待签署   │───▶│ 签署中   │───▶│ 已生效   │
│(创建中)  │    │(待签约)  │    │(签约中)  │    │(服务中)  │
└──────────┘    └──────────┘    └──────────┘    └────┬─────┘
                                                     │
    ┌────────────────────────────────────────────────┘
    ▼
┌──────────┐    ┌──────────┐
│ 已到期   │◀───│ 已换人   │
│(待续约)  │    │(换人后)  │
└──────────┘    └──────────┘
```

**状态说明**：
| 状态 | 说明 | 可执行操作 |
|-----|------|-----------|
| **草稿** | 合同创建中，信息待完善 | 编辑、删除、提交签署 |
| **待签署** | 合同已提交，等待签署 | 查看、取消、重新发起 |
| **签署中** | 合同签署进行中 | 查看进度、催签 |
| **已生效** | 合同签署完成，服务中 | 查看、换人、续约 |
| **已到期** | 合同服务期满 | 查看、续约、归档 |
| **已换人** | 合同已执行换人 | 查看新合同、历史追溯 |
| **已取消** | 合同已取消 | 查看、删除 |

#### 3.3.5 电子签约流程

**签约前准备**：
1. 在爱签平台配置合同模板
2. 配置模板参数（客户信息、阿姨信息、服务信息、费用信息）
3. 获取模板编号

**签约流程**：
```
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│ 创建合同  │───▶│ 添加签署人│───▶│ 发起签署  │───▶│ 客户签署  │
│(CRM系统) │    │(客户/阿姨)│    │(爱签平台) │    │(短信链接) │
└──────────┘    └──────────┘    └──────────┘    └────┬─────┘
                                                     │
    ┌────────────────────────────────────────────────┘
    ▼
┌──────────┐    ┌──────────┐    ┌──────────┐
│ 阿姨签署  │───▶│ 签署完成  │───▶│ 合同归档  │
│(短信链接) │    │(状态更新) │    │(PDF存储) │
└──────────┘    └──────────┘    └──────────┘
```

**签约方式**：
| 方式 | 说明 | 适用场景 |
|-----|------|---------|
| **短信签约** | 发送签署链接到手机 | 标准流程 |
| **刷脸签约** | 人脸识别+签名 | 高价值合同 |
| **密码签约** | 预设签约密码 | 便捷签署 |

#### 3.3.6 换人管理

**换人场景**：
| 场景 | 说明 | 处理方式 |
|-----|------|---------|
| **阿姨原因** | 阿姨因个人原因无法继续 | 协商换人 |
| **客户原因** | 客户对阿姨服务不满意 | 协商换人 |
| **档期冲突** | 阿姨档期无法协调 | 协商换人 |
| **意外情况** | 突发情况无法继续 | 紧急换人 |

**换人流程**：
1. 在现有合同上发起换人申请
2. 记录换人原因
3. 从简历库中选择新阿姨
4. 客户面试新阿姨
5. 确认换人，生成换人补充协议
6. 双方签署补充协议
7. 原合同标记为"已换人"
8. 新合同生效，继承原合同剩余服务期

**换人规则**：
| 规则 | 说明 |
|-----|------|
| 换人次数 | 单合同最多换人 2 次 |
| 费用处理 | 已支付费用按比例结算 |
| 服务期限 | 新合同继承剩余服务期 |
| 合同编号 | 生成新合同编号，关联原合同 |

#### 3.3.7 到期提醒机制

| 提醒节点 | 提前时间 | 提醒方式 | 接收人 |
|---------|---------|---------|-------|
| **即将到期** | 30天 | 站内信+邮件 | 顾问、经理 |
| **到期预警** | 7天 | 站内信+短信 | 顾问、客户 |
| **到期当天** | 0天 | 站内信+短信 | 顾问、客户、阿姨 |
| **到期后** | +3天 | 站内信 | 顾问、经理 |

#### 3.3.8 核心功能清单

| 功能模块 | 功能点 | 功能描述 | 适用角色 |
|---------|-------|---------|---------|
| **合同列表** | 列表展示 | 分页展示合同列表 | 全员 |
| | 状态筛选 | 按合同状态筛选 | 全员 |
| | 到期提醒 | 显示即将到期合同 | 全员 |
| | 搜索查询 | 按合同号、客户名搜索 | 全员 |
| **合同详情** | 信息展示 | 展示合同完整信息 | 全员 |
| | 签署进度 | 查看电子签约进度 | 全员 |
| | 合同下载 | 下载合同PDF | 全员 |
| | 操作历史 | 查看合同操作记录 | 全员 |
| **创建合同** | 表单录入 | 录入合同信息 | 员工 |
| | 客户选择 | 从客户库选择 | 员工 |
| | 阿姨选择 | 从简历库选择 | 员工 |
| | 模板选择 | 选择合同模板 | 员工 |
| **电子签约** | 发起签署 | 发起爱签电子签约 | 员工 |
| | 获取链接 | 获取签署链接 | 员工 |
| | 发送通知 | 发送签署提醒 | 员工 |
| | 查看进度 | 实时查看签署状态 | 员工 |
| **换人管理** | 发起换人 | 申请合同换人 | 员工 |
| | 选择新阿姨 | 从简历库选择 | 员工 |
| | 生成协议 | 生成换人补充协议 | 员工 |
| | 历史追溯 | 查看换人历史 | 全员 |
| **到期管理** | 到期列表 | 查看即将到期合同 | 员工 |
| | 续约处理 | 合同续约操作 | 员工 |
| | 归档处理 | 合同归档 | 员工 |

#### 3.3.9 API 接口列表

| 接口 | 方法 | 路径 | 说明 |
|-----|------|------|------|
| 获取合同列表 | GET | /api/contracts | 支持分页、筛选 |
| 获取合同详情 | GET | /api/contracts/:id | 包含签署信息 |
| 创建合同 | POST | /api/contracts | 创建新合同 |
| 更新合同 | PATCH | /api/contracts/:id | 更新合同信息 |
| 删除合同 | DELETE | /api/contracts/:id | 删除合同 |
| 发起签约 | POST | /api/contracts/:id/sign | 发起电子签约 |
| 获取签署链接 | GET | /api/contracts/:id/sign-urls | 获取签署链接 |
| 查询签署状态 | GET | /api/contracts/:id/sign-status | 查询签约状态 |
| 换人申请 | POST | /api/contracts/:id/change-worker | 申请换人 |
| 续约合同 | POST | /api/contracts/:id/renew | 合同续约 |
| 下载合同 | GET | /api/contracts/:id/download | 下载合同PDF |

---

### 3.4 视频面试模块

#### 3.4.1 模块概述

视频面试模块基于 ZEGO 音视频技术，提供稳定、高清的视频面试服务，支持 HR 端（CRM 系统）与客户端（小程序/H5）之间的实时视频沟通。

**业务目标**：
- 提供便捷的远程面试方式
- 降低面试时间和成本
- 提升客户体验
- 支持多人协同面试

#### 3.4.2 技术架构

```
┌─────────────────────────────────────────────────────────────┐
│                        视频面试架构                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   ┌─────────────┐         ZEGO 云服务         ┌───────────┐ │
│   │  HR端(CRM)  │◀───────────────────────────▶│  音视频   │ │
│   │  (主持人)   │         实时传输            │  服务器   │ │
│   └──────┬──────┘                             └─────┬─────┘ │
│          │                                          │       │
│          │                                          │       │
│   ┌──────▼──────┐                          ┌────────▼────┐ │
│   │  小程序端   │◀─────────────────────────▶│  信令服务器  │ │
│   │ (客户/阿姨) │                           │  (房间管理)  │ │
│   └─────────────┘                           └─────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**ZEGO 服务组件**：
| 组件 | 功能 | 说明 |
|-----|------|------|
| **实时音视频** | 音视频通话 | 低延迟、高清画质 |
| **房间管理** | 房间创建、加入、离开 | 支持多房间并发 |
| **美颜滤镜** | 实时美颜 | 磨皮、美白、滤镜 |
| **云端录制** | 面试过程录制 | 存储在云端 |
| **屏幕共享** | 共享屏幕内容 | 支持PPT演示 |

#### 3.4.3 功能特性

| 特性 | 描述 | 技术实现 |
|-----|------|---------|
| **多人在线** | 支持 3-6 人同时在线 | ZEGO GroupCall |
| **美颜功能** | 实时美颜、滤镜 | ZEGO 内置美颜 SDK |
| **提词器** | HR 端可发送提示文字 | 自定义信令通道 |
| **房间管理** | 踢人、禁言、关闭摄像头 | 主持人权限控制 |
| **屏幕共享** | HR 端可共享屏幕 | ZEGO 屏幕共享 API |
| **录制回放** | 面试过程录制存储 | ZEGO 云端录制 |
| **AI降噪** | 智能降噪，提升音质 | ZEGO AI 降噪 |

#### 3.4.4 面试流程

**HR 端流程**：
```
登录CRM ──▶ 进入视频面试 ──▶ 创建面试间 ──▶ 生成房间号 ──▶ 分享房间号
                                              │
                                              ▼
结束面试 ◀── 进行面试 ◀── 客户加入 ◀── 等待加入 ◀── 发送给客户
```

**客户端流程**：
```
收到邀请 ──▶ 点击链接 ──▶ 授权摄像头/麦克风 ──▶ 进入房间 ──▶ 视频面试
```

#### 3.4.5 房间管理机制

| 角色 | 权限 | 说明 |
|-----|------|------|
| **主持人（HR）** | 全部权限 | 创建房间、踢人、禁言、关闭摄像头、屏幕共享 |
| **参与者（客户/阿姨）** | 基础权限 | 开启/关闭摄像头、开启/关闭麦克风、发送消息 |

**房间状态**：
| 状态 | 说明 | 持续时间 |
|-----|------|---------|
| **等待中** | 房间已创建，等待参与者加入 | 最长10分钟 |
| **进行中** | 面试进行中 | 无限制 |
| **已结束** | 面试已结束 | - |
| **已解散** | 主持人解散房间 | - |

#### 3.4.6 提词器功能

**使用场景**：
- HR 提醒面试注意事项
- 提示阿姨自我介绍要点
- 提醒客户准备问题

**消息类型**：
| 类型 | 说明 | 显示方式 |
|-----|------|---------|
| **文字消息** | 发送文字提示 | 弹窗显示 |
| **快捷短语** | 预设常用短语 | 一键发送 |

#### 3.4.7 核心功能清单

| 功能模块 | 功能点 | 功能描述 | 适用角色 |
|---------|-------|---------|---------|
| **创建面试** | 创建房间 | HR 创建视频面试间 | 员工 |
| | 生成Token | 获取 ZEGO 接入Token | 系统自动 |
| | 分享房间 | 生成分享链接/房间号 | 员工 |
| **加入面试** | 扫码加入 | 扫码加入房间 | 客户/阿姨 |
| | 链接加入 | 点击链接加入 | 客户/阿姨 |
| | 小程序加入 | 小程序内加入 | 客户/阿姨 |
| **面试控制** | 美颜设置 | 调整美颜参数 | 全员 |
| | 摄像头控制 | 开启/关闭摄像头 | 全员 |
| | 麦克风控制 | 开启/关闭麦克风 | 全员 |
| | 屏幕共享 | 共享屏幕内容 | 主持人 |
| **房间管理** | 成员列表 | 查看在线成员 | 主持人 |
| | 踢出成员 | 将成员移出房间 | 主持人 |
| | 禁言控制 | 禁止/允许发言 | 主持人 |
| | 关闭摄像头 | 远程关闭成员摄像头 | 主持人 |
| **提词器** | 发送消息 | 发送提示文字 | 主持人 |
| | 快捷短语 | 使用预设短语 | 主持人 |
| **面试记录** | 录制视频 | 录制面试过程 | 系统自动 |
| | 查看记录 | 查看历史面试 | 员工 |
| | 下载视频 | 下载面试录像 | 员工 |

#### 3.4.8 API 接口列表

| 接口 | 方法 | 路径 | 说明 |
|-----|------|------|------|
| 获取 ZEGO 配置 | GET | /api/zego/config | 获取 ZEGO 配置信息 |
| 生成 Token | POST | /api/zego/token | 生成 ZEGO 接入Token |
| 创建房间 | POST | /api/interview/rooms | 创建面试房间 |
| 获取房间信息 | GET | /api/interview/rooms/:id | 获取房间信息 |
| 结束房间 | POST | /api/interview/rooms/:id/end | 结束面试房间 |
| 发送提词 | POST | /api/interview/rooms/:id/teleprompter | 发送提词消息 |
| 获取面试记录 | GET | /api/interview/records | 获取面试记录列表 |

---

### 3.5 保险管理模块

#### 3.5.1 模块概述

保险管理模块与大树保平台深度集成，提供家政人员雇主责任险的在线投保、保单管理、理赔协助等功能，保障家政服务过程中的风险。

**业务目标**：
- 降低服务风险
- 保障阿姨权益
- 提升客户信任
- 简化投保流程

#### 3.5.2 保险产品

**产品一：家政无忧雇主责任险**

| 项目 | 内容 |
|-----|------|
| **承保公司** | 平安保险 |
| **投保对象** | 家政企业、个体工商户 |
| **被保人** | 16-65周岁家政服务人员 |
| **保障期限** | 1年/1月（灵活选择）|

**保障内容**：
| 保障项目 | 方案A | 方案B | 方案C | 方案D |
|---------|-------|-------|-------|-------|
| **身故伤残** | 10万 | 20万 | 30万 | 40万 |
| **医疗费用** | 1万 | 2万 | 3万 | 4万 |
| **误工费** | 50元/天 | 80元/天 | 100元/天 | 120元/天 |
| **住院津贴** | 50元/天 | 80元/天 | 100元/天 | 120元/天 |
| **第三者责任** | 100万 | 200万 | 300万 | 400万 |
| **年缴价格** | 110元 | 160元 | 280元 | 360元 |
| **月缴价格** | - | 20元 | 40元 | 50元 |

**产品二：大树保服务无忧保障计划**

| 项目 | 计划一 | 计划二 |
|-----|-------|-------|
| **年缴价格** | 100元 | 120元 |
| **月缴价格** | 10元 | 12元 |

#### 3.5.3 投保流程

```
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│ 选择产品  │───▶│ 填写信息  │───▶│ 确认投保  │───▶│ 支付保费  │
│(方案/计划)│    │(人员信息) │    │(信息确认) │    │(在线支付) │
└──────────┘    └──────────┘    └──────────┘    └────┬─────┘
                                                     │
    ┌────────────────────────────────────────────────┘
    ▼
┌──────────┐    ┌──────────┐
│ 保单生效  │───▶│ 保单管理  │
│(大树保)   │    │(下载/打印)│
└──────────┘    └──────────┘
```

**投保信息字段**：
| 字段 | 说明 | 必填 |
|-----|------|------|
| 投保人信息 | 企业名称、统一社会信用代码 | 是 |
| 产品方案 | 选择保障方案 | 是 |
| 缴费方式 | 年缴/月缴 | 是 |
| 生效日期 | 保单生效日期 | 是 |
| 被保险人列表 | 阿姨姓名、身份证号、手机号 | 是 |

#### 3.5.4 保单管理

**保单状态**：
| 状态 | 说明 | 可执行操作 |
|-----|------|-----------|
| **待支付** | 已提交，等待支付 | 支付、取消 |
| **处理中** | 支付完成，保单生成中 | 查询进度 |
| **已生效** | 保单已生效 | 查看、下载、批改、退保 |
| **已过期** | 保单已到期 | 查看、续保 |
| **已退保** | 保单已退保 | 查看 |
| **已注销** | 保单已注销 | 查看 |

**批改操作**：
| 操作 | 说明 | 限制 |
|-----|------|------|
| **批增** | 增加被保险人 | 生效期内可操作 |
| **批减** | 减少被保险人 | 生效期内可操作 |
| **信息修改** | 修改被保险人信息 | 生效期内可操作 |

#### 3.5.5 核心功能清单

| 功能模块 | 功能点 | 功能描述 | 适用角色 |
|---------|-------|---------|---------|
| **产品展示** | 产品列表 | 展示可投保产品 | 全员 |
| | 产品详情 | 查看保障内容、价格 | 全员 |
| | 方案对比 | 对比不同方案 | 全员 |
| **在线投保** | 填写投保单 | 录入投保信息 | 员工 |
| | 选择方案 | 选择保障方案 | 员工 |
| | 添加被保人 | 添加阿姨信息 | 员工 |
| | 确认投保 | 确认并提交 | 员工 |
| **保单管理** | 保单列表 | 查看所有保单 | 全员 |
| | 保单详情 | 查看保单详细信息 | 全员 |
| | 保单下载 | 下载电子保单 | 全员 |
| | 保单打印 | 打印保单 | 全员 |
| **批改管理** | 批增人员 | 增加被保险人 | 员工 |
| | 批减人员 | 减少被保险人 | 员工 |
| | 信息修改 | 修改被保人信息 | 员工 |
| **续保管理** | 到期提醒 | 保单到期提醒 | 系统自动 |
| | 在线续保 | 保单续保操作 | 员工 |
| **退保管理** | 退保申请 | 申请退保 | 员工 |
| | 退保查询 | 查询退保进度 | 员工 |
| **发票管理** | 发票申请 | 申请电子发票 | 员工 |
| | 发票下载 | 下载电子发票 | 员工 |

#### 3.5.6 API 接口列表

| 接口 | 方法 | 路径 | 说明 |
|-----|------|------|------|
| 获取产品列表 | GET | /api/dashubao/products | 获取保险产品列表 |
| 创建保单 | POST | /api/dashubao/policy | 创建新保单 |
| 查询保单 | POST | /api/dashubao/policy/query | 查询保单状态 |
| 注销保单 | POST | /api/dashubao/policy/cancel | 注销未生效保单 |
| 打印保单 | POST | /api/dashubao/policy/print | 打印保单PDF |
| 申请发票 | POST | /api/dashubao/policy/invoice | 申请电子发票 |
| 退保 | POST | /api/dashubao/policy/surrender | 保单退保 |
| 批改保单 | POST | /api/dashubao/policy/amend | 批改保单信息 |
| 批增人员 | POST | /api/dashubao/policy/add-insured | 增加被保险人 |

---

### 3.6 通知系统

#### 3.6.1 模块概述

通知系统提供站内信、WebSocket 实时推送、微信订阅消息三种通知方式，确保重要信息及时触达相关人员。

**业务目标**：
- 及时传递重要信息
- 提升工作效率
- 降低信息遗漏
- 支持多渠道触达

#### 3.6.2 通知类型

**客户相关通知**：
| 通知类型 | 触发场景 | 接收人 | 优先级 |
|---------|---------|-------|-------|
| 客户分配通知 | 客户被分配给员工 | 被分配员工 | 高 |
| 客户转移通知 | 客户负责人变更 | 原负责人、新负责人 | 中 |
| 客户回收通知 | 客户被回收到公海 | 原负责人 | 中 |
| 新客户通知 | 新线索录入 | 管理员、经理 | 中 |

**简历相关通知**：
| 通知类型 | 触发场景 | 接收人 | 优先级 |
|---------|---------|-------|-------|
| 新简历通知 | 新阿姨注册/录入 | 管理员 | 中 |
| 简历分配通知 | 简历被分配 | 被分配员工 | 中 |

**合同相关通知**：
| 通知类型 | 触发场景 | 接收人 | 优先级 |
|---------|---------|-------|-------|
| 合同创建通知 | 新合同创建 | 相关员工 | 中 |
| 合同签署通知 | 合同签署完成 | 相关员工 | 高 |
| 合同换人通知 | 合同换人操作 | 相关员工 | 高 |
| 合同到期提醒 | 合同即将到期 | 相关员工 | 高 |

**报表相关通知**：
| 通知类型 | 触发场景 | 接收人 | 优先级 |
|---------|---------|-------|-------|
| 个人日报 | 每日工作数据 | 个人 | 低 |
| 团队日报 | 团队数据汇总 | 经理 | 中 |
| 周报 | 周度数据汇总 | 经理、管理员 | 中 |
| 月报 | 月度数据汇总 | 经理、管理员 | 中 |

**系统相关通知**：
| 通知类型 | 触发场景 | 接收人 | 优先级 |
|---------|---------|-------|-------|
| 系统公告 | 重要通知 | 全员 | 高 |
| 权限变更 | 权限调整 | 本人 | 高 |
| 账号安全 | 异常登录 | 本人 | 高 |

#### 3.6.3 通知渠道

| 渠道 | 特点 | 适用场景 | 时效性 |
|-----|------|---------|-------|
| **站内信** | 系统内消息中心，永久保存 | 所有通知 | 实时 |
| **WebSocket** | 实时推送，即时显示 | 紧急通知 | 即时 |
| **微信订阅** | 小程序订阅消息 | 客户分配等 | 5分钟内 |
| **短信** | 手机短信 | 重要提醒 | 1分钟内 |
| **邮件** | 邮件通知 | 日报/周报 | 定时发送 |

#### 3.6.4 通知模板

**客户分配通知模板**：
```
标题：新客户分配通知
内容：您有一个新客户待跟进
      客户姓名：{customerName}
      联系电话：{phone}
      线索来源：{leadSource}
      分配时间：{assignTime}
操作：查看详情
```

**合同签署完成通知模板**：
```
标题：合同签署完成
内容：客户 {customerName} 的合同已签署完成
      合同编号：{contractNumber}
      服务类型：{serviceType}
      生效日期：{startDate}
操作：查看合同
```

#### 3.6.5 核心功能清单

| 功能模块 | 功能点 | 功能描述 | 适用角色 |
|---------|-------|---------|---------|
| **通知中心** | 通知列表 | 查看所有通知 | 全员 |
| | 未读提醒 | 未读消息数量提示 | 全员 |
| | 消息筛选 | 按类型筛选通知 | 全员 |
| | 消息搜索 | 搜索历史通知 | 全员 |
| **消息操作** | 标记已读 | 单条标记已读 | 全员 |
| | 批量已读 | 批量标记已读 | 全员 |
| | 全部已读 | 一键全部已读 | 全员 |
| | 删除消息 | 删除通知 | 全员 |
| **通知设置** | 接收设置 | 配置接收渠道 | 全员 |
| | 免打扰 | 设置免打扰时段 | 全员 |
| | 类型订阅 | 订阅/取消某类通知 | 全员 |
| **实时推送** | WebSocket连接 | 建立实时连接 | 自动 |
| | 在线状态 | 显示在线状态 | 全员 |
| | 断线重连 | 自动重连机制 | 自动 |

#### 3.6.6 API 接口列表

| 接口 | 方法 | 路径 | 说明 |
|-----|------|------|------|
| 获取通知列表 | GET | /api/notifications | 获取用户通知列表 |
| 获取未读数量 | GET | /api/notifications/unread-count | 获取未读通知数量 |
| 标记已读 | PUT | /api/notifications/mark-read | 标记通知为已读 |
| 标记全部已读 | PUT | /api/notifications/mark-all-read | 标记全部已读 |
| 删除通知 | DELETE | /api/notifications/:id | 删除通知 |
| 获取通知设置 | GET | /api/notifications/settings | 获取通知设置 |
| 更新通知设置 | PUT | /api/notifications/settings | 更新通知设置 |

---

### 3.7 用户权限管理

#### 3.7.1 角色体系

| 角色 | 权限范围 | 适用人员 | 人数建议 |
|-----|---------|---------|---------|
| **系统管理员** | 所有权限，系统级操作 | 技术/运维人员 | 1-2人 |
| **经理/主管** | 团队管理、数据查看、业务审批 | 部门主管 | 每部门1-2人 |
| **员工** | 日常业务操作，个人数据 | 家政顾问 | 不限 |
| **财务** | 财务相关操作、报表查看 | 财务人员 | 1-2人 |
| **客服** | 客户查看、跟进记录 | 客服人员 | 不限 |

#### 3.7.2 权限清单

**客户管理权限**：
| 权限项 | 权限标识 | 说明 | 管理员 | 经理 | 员工 |
|-------|---------|------|-------|------|------|
| 查看客户 | customer:view | 查看客户列表和详情 | ✓ | ✓ | ✓(自己的) |
| 创建客户 | customer:create | 创建新客户 | ✓ | ✓ | ✓ |
| 编辑客户 | customer:edit | 编辑客户信息 | ✓ | ✓ | ✓(自己的) |
| 删除客户 | customer:delete | 删除客户 | ✓ | ✓ | ✗ |
| 分配客户 | customer:assign | 分配客户给员工 | ✓ | ✓ | ✗ |
| 导出客户 | customer:export | 导出客户数据 | ✓ | ✓ | ✗ |
| 查看全部 | customer:view:all | 查看所有客户 | ✓ | ✓(本团队) | ✗ |

**简历管理权限**：
| 权限项 | 权限标识 | 说明 | 管理员 | 经理 | 员工 |
|-------|---------|------|-------|------|------|
| 查看简历 | resume:view | 查看简历列表和详情 | ✓ | ✓ | ✓ |
| 创建简历 | resume:create | 创建新简历 | ✓ | ✓ | ✓ |
| 编辑简历 | resume:edit | 编辑简历信息 | ✓ | ✓ | ✓ |
| 删除简历 | resume:delete | 删除简历 | ✓ | ✓ | ✗ |
| 导出简历 | resume:export | 导出简历数据 | ✓ | ✓ | ✗ |

**合同管理权限**：
| 权限项 | 权限标识 | 说明 | 管理员 | 经理 | 员工 |
|-------|---------|------|-------|------|------|
| 查看合同 | contract:view | 查看合同列表和详情 | ✓ | ✓ | ✓(自己的) |
| 创建合同 | contract:create | 创建新合同 | ✓ | ✓ | ✓ |
| 编辑合同 | contract:edit | 编辑合同信息 | ✓ | ✓ | ✓(自己的) |
| 删除合同 | contract:delete | 删除合同 | ✓ | ✓ | ✗ |
| 发起签约 | contract:sign | 发起电子签约 | ✓ | ✓ | ✓ |
| 合同审批 | contract:approve | 审批合同 | ✓ | ✓ | ✗ |

**系统管理权限**：
| 权限项 | 权限标识 | 说明 | 管理员 | 经理 | 员工 |
|-------|---------|------|-------|------|------|
| 用户管理 | admin:users | 管理系统用户 | ✓ | ✗ | ✗ |
| 角色管理 | admin:roles | 管理角色权限 | ✓ | ✗ | ✗ |
| 系统设置 | admin:settings | 系统参数配置 | ✓ | ✗ | ✗ |
| 数据备份 | admin:backup | 数据备份恢复 | ✓ | ✗ | ✗ |
| 日志查看 | admin:logs | 查看系统日志 | ✓ | ✗ | ✗ |

#### 3.7.3 数据权限规则

**客户数据**：
| 角色 | 可见范围 | 操作限制 |
|-----|---------|---------|
| 管理员 | 全部客户 | 无限制 |
| 经理 | 本团队客户 | 可分配、可转移 |
| 员工 | 自己的客户 | 仅可操作自己的客户 |

**合同数据**：
| 角色 | 可见范围 | 操作限制 |
|-----|---------|---------|
| 管理员 | 全部合同 | 无限制 |
| 经理 | 本团队合同 | 可审批、可查看 |
| 员工 | 自己创建的合同 | 仅可操作自己的合同 |

#### 3.7.4 核心功能清单

| 功能模块 | 功能点 | 功能描述 | 适用角色 |
|---------|-------|---------|---------|
| **用户管理** | 用户列表 | 查看系统用户 | 管理员 |
| | 创建用户 | 添加新用户 | 管理员 |
| | 编辑用户 | 修改用户信息 | 管理员 |
| | 禁用用户 | 禁用/启用账号 | 管理员 |
| | 重置密码 | 重置用户密码 | 管理员 |
| | 分配角色 | 分配用户角色 | 管理员 |
| **角色管理** | 角色列表 | 查看角色列表 | 管理员 |
| | 创建角色 | 创建新角色 | 管理员 |
| | 编辑角色 | 修改角色信息 | 管理员 |
| | 权限配置 | 配置角色权限 | 管理员 |
| | 删除角色 | 删除角色 | 管理员 |
| **部门管理** | 部门列表 | 查看部门结构 | 管理员 |
| | 创建部门 | 添加新部门 | 管理员 |
| | 编辑部门 | 修改部门信息 | 管理员 |
| | 部门人员 | 管理部门人员 | 管理员 |

#### 3.7.5 API 接口列表

| 接口 | 方法 | 路径 | 说明 |
|-----|------|------|------|
| 获取用户列表 | GET | /api/users | 获取系统用户列表 |
| 创建用户 | POST | /api/users | 创建新用户 |
| 更新用户 | PATCH | /api/users/:id | 更新用户信息 |
| 删除用户 | DELETE | /api/users/:id | 删除用户 |
| 重置密码 | POST | /api/users/:id/reset-password | 重置用户密码 |
| 获取角色列表 | GET | /api/roles | 获取角色列表 |
| 创建角色 | POST | /api/roles | 创建新角色 |
| 更新角色 | PATCH | /api/roles/:id | 更新角色信息 |
| 删除角色 | DELETE | /api/roles/:id | 删除角色 |
| 获取权限列表 | GET | /api/permissions | 获取权限列表 |

---

## 4. 小程序端功能

### 4.1 小程序概述

微信小程序端主要面向客户和阿姨（服务人员），提供便捷的服务入口。采用微信原生小程序开发，支持 iOS 和 Android 双平台。

**小程序类型**：
| 类型 | 名称 | 面向用户 | 主要功能 |
|-----|------|---------|---------|
| **客户端小程序** | 安得家政 | 客户 | 需求发布、阿姨筛选、面试预约、合同查看 |
| **阿姨端小程序** | 安得阿姨 | 阿姨 | 简历管理、档期设置、接单服务、视频面试 |

### 4.2 客户端小程序功能

#### 4.2.1 首页

**功能模块**：
| 模块 | 功能描述 |
|-----|---------|
| **Banner轮播** | 展示优惠活动、服务介绍 |
| **快捷入口** | 快速发布需求、查找阿姨、联系客服 |
| **服务分类** | 月嫂、育儿嫂、保姆、钟点工、养老护理 |
| **推荐阿姨** | 系统推荐的优质阿姨 |
| **最新动态** | 平台公告、活动通知 |

#### 4.2.2 需求发布

**发布流程**：
```
选择服务类型 ──▶ 填写需求信息 ──▶ 选择服务时间 ──▶ 填写联系方式 ──▶ 提交需求
```

**需求信息字段**：
| 字段 | 说明 | 必填 |
|-----|------|------|
| 服务类型 | 月嫂/育儿嫂/保姆/钟点工/养老护理 | 是 |
| 服务地址 | 详细服务地址 | 是 |
| 服务时间 | 期望开始时间 | 是 |
| 服务要求 | 具体服务要求描述 | 否 |
| 预算范围 | 可接受的价格范围 | 否 |
| 联系电话 | 联系手机号 | 是 |

#### 4.2.3 阿姨筛选

**筛选条件**：
| 条件 | 选项 |
|-----|------|
| 工种 | 月嫂/育儿嫂/保姆/钟点工/养老护理 |
| 年龄 | 30-40岁/40-50岁/50岁以上 |
| 经验 | 1-3年/3-5年/5-10年/10年以上 |
| 籍贯 | 各省/直辖市 |
| 薪资范围 | 价格区间筛选 |
| 技能标签 | 多选技能标签 |

**阿姨展示信息**：
| 信息 | 说明 |
|-----|------|
| 头像 | 阿姨照片 |
| 姓名 | 阿姨姓名（脱敏）|
| 年龄 | 阿姨年龄 |
| 籍贯 | 籍贯信息 |
| 经验 | 工作年限 |
| 技能 | 技能标签 |
| 薪资 | 期望薪资 |
| 评分 | 客户评价评分 |

#### 4.2.4 视频面试

**面试流程**：
```
选择阿姨 ──▶ 发起面试邀请 ──▶ 等待阿姨确认 ──▶ 进入视频面试 ──▶ 面试完成评价
```

**面试功能**：
| 功能 | 说明 |
|-----|------|
| 美颜功能 | 实时美颜 |
| 麦克风控制 | 开启/关闭麦克风 |
| 摄像头控制 | 开启/关闭摄像头 |
| 切换摄像头 | 前置/后置切换 |
| 结束面试 | 结束视频通话 |

#### 4.2.5 合同管理

**功能列表**：
| 功能 | 说明 |
|-----|------|
| 合同列表 | 查看所有合同 |
| 合同详情 | 查看合同详细信息 |
| 电子签约 | 在线签署合同 |
| 合同下载 | 下载电子合同 |

#### 4.2.6 个人中心

**功能模块**：
| 模块 | 功能 |
|-----|------|
| **个人信息** | 查看/编辑个人信息 |
| **我的需求** | 查看发布的需求 |
| **我的合同** | 查看签订的合同 |
| **我的面试** | 查看面试记录 |
| **消息通知** | 查看系统通知 |
| **联系客服** | 在线客服咨询 |
| **设置** | 账号设置、关于我们 |

### 4.3 阿姨端小程序功能

#### 4.3.1 首页

**功能模块**：
| 模块 | 功能描述 |
|-----|---------|
| **工作统计** | 本月收入、订单数量、评价数量 |
| **快捷操作** | 编辑简历、设置档期、查看订单 |
| **消息通知** | 面试邀请、订单通知、系统消息 |
| **推荐订单** | 系统推荐的匹配订单 |
| **培训学习** | 在线培训课程入口 |

#### 4.3.2 简历管理

**简历信息**：
| 信息类别 | 包含内容 |
|---------|---------|
| **基础信息** | 姓名、性别、年龄、籍贯、民族 |
| **联系信息** | 手机号、紧急联系人 |
| **工作信息** | 工种、经验年限、期望薪资、服务区域 |
| **技能证书** | 技能标签、证书照片 |
| **个人照片** | 生活照、工作照 |
| **自我介绍** | 个人介绍、服务优势 |

**编辑功能**：
| 功能 | 说明 |
|-----|------|
| 修改基础信息 | 编辑个人基本信息 |
| 上传照片 | 上传个人照片 |
| 添加证书 | 上传技能证书 |
| 更新技能 | 选择技能标签 |
| 修改自我介绍 | 编辑个人介绍 |

#### 4.3.3 档期管理

**接单状态**：
| 状态 | 说明 |
|-----|------|
| **待业** | 可接单，等待匹配 |
| **在职** | 正在服务中 |
| **暂不接单** | 暂时无法接受新订单 |

**档期设置**：
| 功能 | 说明 |
|-----|------|
| 设置可接单时间 | 选择可接单日期 |
| 标记已预约时间 | 标记已被预约时间 |
| 设置不可接单时间 | 设置休息日 |

#### 4.3.4 订单管理

**订单状态**：
| 状态 | 说明 |
|-----|------|
| **待确认** | 收到订单邀请，待确认 |
| **待面试** | 已确认，等待面试 |
| **待签约** | 面试通过，等待签约 |
| **服务中** | 合同已生效，服务中 |
| **已完成** | 服务已完成 |
| **已取消** | 订单已取消 |

**订单操作**：
| 操作 | 说明 |
|-----|------|
| 接受订单 | 接受客户订单邀请 |
| 拒绝订单 | 拒绝客户订单邀请 |
| 查看详情 | 查看订单详细信息 |
| 联系客户 | 联系客户沟通 |

#### 4.3.5 收入管理

**功能列表**：
| 功能 | 说明 |
|-----|------|
| 收入统计 | 本月收入、累计收入 |
| 收入明细 | 每笔收入明细 |
| 提现申请 | 申请提现 |
| 提现记录 | 查看提现历史 |

#### 4.3.6 培训学习

**培训内容**：
| 类别 | 课程 |
|-----|------|
| **技能培训** | 母婴护理、育婴知识、烹饪技巧 |
| **服务规范** | 服务礼仪、沟通技巧、安全知识 |
| **政策法规** | 劳动法规、家政行业规范 |

### 4.4 小程序技术架构

```
┌─────────────────────────────────────────┐
│           微信小程序端                   │
├─────────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────┐   │
│  │  首页   │ │  分类   │ │  我的   │   │
│  └────┬────┘ └────┬────┘ └────┬────┘   │
│       │           │           │        │
│       └───────────┼───────────┘        │
│                   │                    │
│            ┌──────▼──────┐             │
│            │  API 服务层  │             │
│            │(封装wx.request)│            │
│            └──────┬──────┘             │
│                   │                    │
│            ┌──────▼──────┐             │
│            │  CRM 后端   │             │
│            │   API      │             │
│            └─────────────┘             │
└─────────────────────────────────────────┘
```

**技术栈**：
| 技术 | 说明 |
|-----|------|
| **微信原生小程序** | 官方框架 |
| **WXS** | 小程序脚本语言 |
| **微信云函数** | 服务端逻辑 |
| **微信订阅消息** | 消息推送 |

---

## 5. 第三方服务集成

### 5.1 爱签电子签约

#### 5.1.1 服务概述

爱签是国内领先的电子签约平台，提供符合《电子签名法》的合法电子签约服务。

**集成方式**：REST API

**核心能力**：
- 合同模板管理
- 合同创建与签署
- 签署人身份认证
- 合同存证保全
- 合同法律效力保障

#### 5.1.2 集成架构

```
┌─────────────┐      ┌─────────────┐      ┌─────────────┐
│   CRM系统    │◀────▶│   爱签API    │◀────▶│   爱签平台   │
│             │      │             │      │             │
│ • 合同创建   │      │ • 合同接口   │      │ • 合同存储   │
│ • 签署发起   │      │ • 签署接口   │      │ • 身份认证   │
│ • 状态查询   │      │ • 查询接口   │      │ • 时间戳服务 │
│ • 合同下载   │      │ • 回调通知   │      │ • 存证保全   │
└─────────────┘      └─────────────┘      └─────────────┘
```

#### 5.1.3 核心接口

| 接口 | 说明 |
|-----|------|
| 获取AccessToken | 获取API访问令牌 |
| 创建合同 | 基于模板创建合同 |
| 添加签署人 | 添加合同签署方 |
| 获取签署链接 | 获取签署页面链接 |
| 查询合同状态 | 查询合同签署状态 |
| 下载合同 | 下载签署完成的合同 |

#### 5.1.4 签约流程

```
1. 创建合同 ──▶ 2. 添加签署人 ──▶ 3. 发起签署 ──▶ 4. 签署人签署
                                              │
                                              ▼
5. 签署完成 ◀── 4. 签署人签署 ◀── 3. 发起签署 ◀── 2. 添加签署人
```

### 5.2 大树保保险

#### 5.2.1 服务概述

大树保是专业的互联网保险平台，提供家政行业雇主责任险产品。

**集成方式**：XML WebService

**核心能力**：
- 在线投保
- 保单管理
- 批改批增
- 电子发票
- 理赔服务

#### 5.2.2 接口类型

| 接口类型 | 说明 |
|---------|------|
| 投保确认(0002) | 提交投保信息 |
| 保单注销(0004) | 注销未生效保单 |
| 保单查询(0005) | 查询保单状态 |
| 保单打印(0006) | 获取保单PDF |
| 电子发票(0008) | 申请电子发票 |
| 批改接口(0007) | 修改保单信息 |
| 批增接口 | 增加被保险人 |

### 5.3 ZEGO 即构音视频

#### 5.3.1 服务概述

ZEGO 即构科技提供稳定、高质量的实时音视频云服务。

**集成方式**：Web SDK + Server API

**核心能力**：
- 实时音视频通话
- 房间管理
- 美颜滤镜
- 屏幕共享
- 云端录制
- AI降噪

#### 5.3.2 技术参数

| 参数 | 规格 |
|-----|------|
| 视频分辨率 | 最高1080P |
| 音频采样率 | 48kHz |
| 延迟 | 端到端 < 300ms |
| 抗丢包率 | 视频70%，音频80% |
| 支持人数 | 单房间最多50人 |

### 5.4 腾讯云 OCR

#### 5.4.1 服务概述

腾讯云 OCR 提供高精度的文字识别服务。

**集成方式**：REST API

**识别能力**：
- 身份证识别
- 银行卡识别
- 驾驶证识别
- 营业执照识别
- 通用文字识别

### 5.5 腾讯云 COS

#### 5.5.1 服务概述

腾讯云对象存储（COS）提供高可靠、低成本的云存储服务。

**集成方式**：SDK + REST API

**存储类型**：
| 类型 | 适用场景 |
|-----|---------|
| 标准存储 | 频繁访问的文件 |
| 低频存储 | 较少访问的文件 |
| 归档存储 | 长期归档的文件 |

---

## 6. 数据安全与合规

### 6.1 数据安全措施

| 措施 | 说明 | 实现方式 |
|-----|------|---------|
| **传输加密** | 全站HTTPS | TLS 1.2+ |
| **存储加密** | 敏感字段加密 | AES-256 |
| **访问控制** | 身份认证+权限控制 | JWT + RBAC |
| **操作审计** | 关键操作记录 | 操作日志 |
| **数据备份** | 定期自动备份 | 每日备份 |
| **容灾恢复** | 多副本存储 | MongoDB副本集 |

### 6.2 隐私保护

| 措施 | 说明 |
|-----|------|
| **数据脱敏** | 手机号、身份证号脱敏展示 |
| **权限隔离** | 数据按权限隔离访问 |
| **敏感操作确认** | 删除等操作二次确认 |
| **数据保留策略** | 按法规要求保留和清理数据 |
| **访问日志** | 记录数据访问日志 |

### 6.3 合规要求

| 法规 | 要求 | 措施 |
|-----|------|------|
| **个人信息保护法** | 个人信息处理合规 | 隐私协议、授权同意 |
| **电子签名法** | 电子签名法律效力 | 爱签电子签约 |
| **网络安全法** | 网络安全保护 | 安全加固、漏洞修复 |
| **数据安全法** | 数据安全保护 | 数据分类分级保护 |

---

## 7. 部署与运维

### 7.1 环境要求

| 环境 | 配置要求 |
|-----|---------|
| **服务器** | 2核4G起步，推荐4核8G |
| **操作系统** | Ubuntu 20.04+ / CentOS 7+ |
| **Node.js** | v18+ LTS |
| **MongoDB** | v5.0+ |
| **Nginx** | v1.18+ |
| **PM2** | v5.0+ |

### 7.2 部署架构

```
                    ┌─────────────┐
                    │   用户访问   │
                    └──────┬──────┘
                           │
                    ┌──────▼──────┐
                    │  Nginx 80   │
                    │  (反向代理)  │
                    └──────┬──────┘
                           │
           ┌───────────────┼───────────────┐
           │               │               │
    ┌──────▼──────┐ ┌──────▼──────┐ ┌──────▼──────┐
    │  前端服务    │ │  后端服务    │ │  MongoDB    │
    │   :4173     │ │   :3000     │ │   :27017    │
    │  (PM2集群)   │ │  (PM2集群)   │ │  (副本集)   │
    └─────────────┘ └─────────────┘ └─────────────┘
```

### 7.3 监控告警

| 监控项 | 告警阈值 | 通知方式 |
|-------|---------|---------|
| CPU使用率 | > 80% | 邮件+短信 |
| 内存使用率 | > 85% | 邮件+短信 |
| 磁盘使用率 | > 90% | 邮件+短信 |
| 服务可用性 | 不可用 | 邮件+短信 |
| API响应时间 | > 2s | 邮件 |
| 错误率 | > 5% | 邮件 |

---

## 8. 使用指南

### 8.1 快速开始

**管理员初始化**：
1. 使用默认管理员账号登录
2. 创建部门和角色
3. 添加员工账号
4. 配置系统参数
5. 配置第三方服务

**员工日常使用**：
1. 登录CRM系统
2. 查看分配的客户
3. 跟进客户并记录
4. 匹配阿姨并推荐
5. 创建合同并签约
6. 处理售后服务

### 8.2 常见问题

| 问题 | 解决方案 |
|-----|---------|
| 无法登录 | 检查账号密码，联系管理员重置 |
| 看不到客户 | 检查权限配置，确认客户分配 |
| 视频面试失败 | 检查网络，确认浏览器权限 |
| 合同签署失败 | 检查爱签配置，确认模板正确 |
| 保险投保失败 | 检查大树保余额，确认产品代码 |
| 收不到通知 | 检查通知设置，确认WebSocket连接 |

---

## 9. 版本历史

| 版本 | 日期 | 更新内容 |
|-----|------|---------|
| v1.0 | 2024-01 | 系统初始版本，基础功能上线 |
| v1.1 | 2024-03 | 新增视频面试功能 |
| v1.2 | 2024-05 | 集成爱签电子签约 |
| v1.3 | 2024-07 | 集成大树保保险 |
| v1.4 | 2024-09 | 新增小程序端 |
| v2.0 | 2024-12 | 系统重构，性能优化，功能完善 |

---

## 10. 联系方式

- **技术支持**：support@andejiazheng.com
- **业务咨询**：business@andejiazheng.com
- **官方网站**：https://crm.andejiazheng.com

---

*文档版本：v2.0*  
*最后更新：2025-02-27*  
*适用系统：安得家政 CRM 全功能版本*

