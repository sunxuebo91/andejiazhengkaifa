# ZEGO 智能美颜功能说明 🎨

## 📋 功能概述

智能美颜功能为用户提供自然不夸张的美颜效果，改善视频画面质量，提升用户形象。

---

## 🎯 美颜参数配置

### 当前使用的参数（固定配置）

```javascript
{
  smoothIntensity: 35,   // 适度磨皮
  whitenIntensity: 25,   // 适度美白
  rosyIntensity: 20,     // 适度红润
  sharpenIntensity: 30   // 适度锐化
}
```

### 参数说明

| 参数 | 取值范围 | 当前值 | 效果说明 |
|------|---------|--------|---------|
| **smoothIntensity** | 0-100 | 35 | 磨皮，保留脸部细节（痣等），自然不夸张 |
| **whitenIntensity** | 0-100 | 25 | 美白，提高画面亮度，改善肤色 |
| **rosyIntensity** | 0-100 | 20 | 红润，增加暖色调，气色更好 |
| **sharpenIntensity** | 0-100 | 30 | 锐化，使轮廓清晰，画面更清楚 |

**配置理念：**
- ✅ 介于轻度和中度之间
- ✅ 自然不夸张
- ✅ 适合正式场合（面试、会议）
- ✅ 男女通用

---

## 🌐 浏览器兼容性

### ✅ 支持的浏览器

| 浏览器 | 最低版本 |
|--------|---------|
| Chrome | 65+ |
| Firefox | 70+ |
| Safari | 12-14 或 15.2+ |
| Edge | 80+ |

### ❌ 不支持的环境

- 移动端浏览器（iOS Safari、Android Chrome 等）
- 微信内嵌网页
- 其他小程序 WebView

**注意：** 在不支持的环境中，美颜功能会自动跳过，不影响正常通话。

---

## 📐 分辨率适配

### 当前分辨率配置

| 页面 | 分辨率 | 美颜参数 |
|------|--------|---------|
| H5VideoRoom.tsx (移动端) | 480x854 (480p) | 标准参数 |
| video-interview-host.html (桌面) | 1280x720 (720p) | 标准参数 + 适度锐化 |
| 其他页面 | 默认配置 | 标准参数 |

**适配说明：**
- 480p：适度磨皮和美白，保持自然
- 720p：增加锐化强度，确保画面清晰

---

## ⚡ 性能影响

### CPU 使用率
- 增加约 **5-10%**（取决于设备性能）
- 在现代设备上影响较小

### 内存占用
- 增加约 **10-20MB**

### 帧率影响
- 可能降低 **1-2 FPS**
- 在 15 FPS 配置下影响不明显

### 优化建议
1. 不需要美颜时及时关闭：`await zg.setEffectsBeauty(localStream, false)`
2. 销毁流时 SDK 会自动关闭美颜
3. 在低性能设备上可以考虑降低美颜参数

---

## 🔧 技术实现

### 启用美颜的时机

```
创建流 → 启用 AI 降噪 → 启用美颜 → 推流
```

**重要：** 必须在推流前启用美颜，等待美颜开启完成后再推流。

### 代码示例

```javascript
// 1. 创建流
const localStream = await zg.createStream({
  camera: {
    video: { width: 1280, height: 720 },
    audio: true
  }
});

// 2. 启用美颜（必须在推流前）
await zg.setEffectsBeauty(localStream, true, {
  smoothIntensity: 35,
  whitenIntensity: 25,
  rosyIntensity: 20,
  sharpenIntensity: 30
});

// 3. 推流
await zg.startPublishingStream(streamID, localStream);
```

### 关闭美颜

```javascript
// 关闭美颜
await zg.setEffectsBeauty(localStream, false);
```

---

## 📊 效果对比

### 开启前
- 原始画面
- 可能有肤色不均、暗沉等问题
- 画面可能略显模糊

### 开启后
- 肤色更均匀、明亮
- 气色更好，更有精神
- 画面更清晰，轮廓分明
- 整体效果自然，不夸张

---

## 🎯 适用场景

### ✅ 推荐使用
- 视频面试
- 在线会议
- 远程医疗
- 在线教育
- 社交视频通话

### ⚠️ 谨慎使用
- 需要真实画面的场景（如医学诊断）
- 低性能设备
- 移动端（不支持）

---

## 🐛 常见问题

### Q1: 美颜效果太强/太弱怎么办？
**A:** 当前使用固定参数，如需调整请联系开发团队修改配置。

### Q2: 移动端为什么没有美颜效果？
**A:** ZEGO SDK 的美颜功能不支持移动端浏览器，这是 SDK 的限制。

### Q3: 美颜会影响性能吗？
**A:** 会有一定影响，但在现代设备上影响较小。如果遇到性能问题，可以关闭美颜。

### Q4: 切换摄像头后美颜还有效吗？
**A:** 美颜效果与 MediaStream 绑定，切换摄像头不会改变美颜效果。

### Q5: 美颜失败会影响通话吗？
**A:** 不会。代码中有完善的错误处理，美颜失败只会在控制台输出警告，不影响正常通话。

---

## 📞 技术支持

如有问题，请提供：
1. 浏览器类型和版本
2. 操作系统
3. 控制台错误日志
4. 问题复现步骤

